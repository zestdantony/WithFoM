# 7: 스탬프 구간별 적립 시스템

## 개요

결제 금액을 구간별로 나누어 각 구간마다 다른 스탬프 적립 개수를 설정할 수 있는 고급 스탬프 적립 시스템입니다. 현재는 배수 적립 방식만 제공되지만, 향후 파트너가 더 세밀하게 스탬프 적립 정책을 설정할 수 있도록 확장 예정입니다.

---

## 현재 구현 상태

### 배수 적립 방식 (현재 제공)

| 결제 금액 | 스탬프 적립 개수 | 계산 방식 |
|---|---|---|
| 3,000원 ~ 5,999원 | 1개 | 기준 금액(3,000원)의 1배 |
| 6,000원 ~ 8,999원 | 2개 | 기준 금액의 2배 |
| 9,000원 ~ 11,999원 | 3개 | 기준 금액의 3배 |

**특징:**
- 기준 금액의 배수로 자동 계산
- 설정이 간단하고 이해하기 쉬움
- 고객이 예측 가능한 적립 구조

**제한사항:**
- 구간별로 다른 적립 비율을 설정할 수 없음
- 예: 3,000~5,000원은 1개, 5,000~10,000원은 3개처럼 비선형 적립 불가

---

## 향후 확장 계획: 구간별 적립 시스템

### Phase 1: 기본 구간별 적립 (18개월 후 출시 예정)

#### 1-1. 구간별 적립 방식

**기본 개념:**
```
파트너가 금액 구간을 직접 설정하고, 각 구간마다 적립 개수를 지정
```

**설정 예시:**
| 구간 | 결제 금액 범위 | 스탬프 적립 개수 |
|---|---|---|
| 구간 1 | 3,000원 ~ 4,999원 | 1개 |
| 구간 2 | 5,000원 ~ 9,999원 | 2개 |
| 구간 3 | 10,000원 ~ 19,999원 | 3개 |
| 구간 4 | 20,000원 이상 | 5개 |

**특징:**
- 파트너가 자유롭게 구간 설정 가능
- 구간별로 다른 적립 비율 적용 가능
- 최대 5개 구간까지 설정 가능

#### 1-2. 구간 설정 인터페이스

```
[구간별 적립 설정]
├── 구간 추가 버튼 (최대 5개)
├── 구간 1
│   ├── 시작 금액: [3,000]원
│   ├── 종료 금액: [4,999]원
│   └── 적립 개수: [1]개
├── 구간 2
│   ├── 시작 금액: [5,000]원
│   ├── 종료 금액: [9,999]원
│   └── 적립 개수: [2]개
└── 구간 삭제 버튼
```

#### 1-3. 구간 검증 로직

| 검증 항목 | 내용 |
|---|---|
| 구간 중복 확인 | 구간이 겹치지 않도록 검증 |
| 구간 누락 확인 | 모든 금액 범위가 커버되도록 검증 |
| 구간 순서 확인 | 시작 금액이 이전 구간 종료 금액과 연속되도록 검증 |
| 최소/최대 금액 | 시작 금액은 기준 금액 이상, 종료 금액은 무제한 가능 |

---

### Phase 2: 고급 구간별 적립 (24개월 후 출시 예정)

#### 2-1. 구간별 차등 적립 비율

**개념:**
```
구간마다 적립 비율을 다르게 설정
예: 구간 1은 10% 적립, 구간 2는 15% 적립
```

**설정 예시:**
| 구간 | 결제 금액 범위 | 적립 비율 | 스탬프 적립 개수 (예시) |
|---|---|---|---|
| 구간 1 | 3,000원 ~ 9,999원 | 10% | 3,000원 → 1개, 5,000원 → 1개 |
| 구간 2 | 10,000원 ~ 19,999원 | 15% | 10,000원 → 2개, 15,000원 → 2개 |
| 구간 3 | 20,000원 이상 | 20% | 20,000원 → 4개, 30,000원 → 6개 |

#### 2-2. 구간별 혜택 연동

**개념:**
```
구간별로 다른 혜택 제공
예: 구간 1 적립 시 일반 혜택, 구간 2 적립 시 프리미엄 혜택
```

**설정 예시:**
| 구간 | 적립 개수 | 혜택 |
|---|---|---|
| 구간 1 (3,000~9,999원) | 1개 | 일반 쿠폰 |
| 구간 2 (10,000~19,999원) | 2개 | 프리미엄 쿠폰 + 추가 혜택 |
| 구간 3 (20,000원 이상) | 3개 | VIP 쿠폰 + 특별 혜택 |

---

## 기술 요구사항

### 데이터베이스 설계

#### 스탬프 구간별 정책 테이블

| 필드 | 타입 | 설명 |
|---|---|---|
| policy_id | UUID | 정책 ID |
| partner_id | UUID | 파트너 ID |
| earn_type | ENUM | 배수/구간별 |
| base_amount | INT | 기준 금액 (배수 적립 시) |
| created_at | TIMESTAMP | 생성 일시 |

#### 스탬프 구간 테이블

| 필드 | 타입 | 설명 |
|---|---|---|
| range_id | UUID | 구간 ID |
| policy_id | UUID | 정책 ID |
| start_amount | INT | 시작 금액 |
| end_amount | INT | 종료 금액 (NULL 시 무제한) |
| stamp_count | INT | 적립 개수 |
| earn_rate | DECIMAL | 적립 비율 (%) (선택) |
| priority | INT | 구간 우선순위 |

### API 설계

#### 1. 구간별 적립 계산 API

```
POST /api/v1/stamps/calculate
{
  "partner_id": "uuid",
  "payment_amount": 15000
}

Response:
{
  "earned_stamps": 2,
  "range_id": "uuid",
  "range_info": {
    "start_amount": 10000,
    "end_amount": 19999,
    "stamp_count": 2
  }
}
```

---

## UI/UX 설계

### 파트너 포털: 구간별 적립 설정

#### 설정 화면 구성

```
[구간별 적립 설정]
├── 적립 방식 선택
│   ├── 배수 적립 (현재 제공)
│   └── 구간별 적립 (향후 제공)
├── 구간 설정
│   ├── 구간 1
│   │   ├── 시작 금액: [___]원
│   │   ├── 종료 금액: [___]원
│   │   └── 적립 개수: [___]개
│   ├── 구간 2
│   └── [구간 추가] 버튼
└── 저장 버튼
```

---

## 비즈니스 모델

### 파트너 혜택

| 혜택 | 설명 |
|---|---|
| 세밀한 적립 정책 | 구간별로 다른 적립 비율로 고객 유도 |
| 매출 증대 | 고가 구간에 더 많은 스탬프 제공으로 고가 주문 유도 |
| 고객 등급화 | 구간별로 다른 혜택 제공으로 VIP 고객 관리 |

### 고객 혜택

| 혜택 | 설명 |
|---|---|
| 명확한 적립 구조 | 구간별로 적립 개수가 명확히 표시 |
| 고가 주문 인센티브 | 더 많이 주문할수록 더 많은 스탬프 적립 |

---

## 고객 경험 고려사항

### 구간별 적립의 오해 가능성

**문제점:**
1. **구간 경계 혼란**
   - 고객: "9,999원 주문했는데 왜 2개만 주나요? 10,000원이면 3개인데..."
   - 해결: 구간 경계를 명확히 표시하고 안내

2. **복잡한 구조**
   - 고객: "배수 적립은 이해하는데, 구간별 적립은 너무 복잡해요"
   - 해결: 간단한 배수 적립을 기본으로 제공, 구간별은 고급 옵션으로 제공

3. **예측 불가능성**
   - 고객: "내가 주문한 금액에 몇 개 적립되는지 모르겠어요"
   - 해결: 결제 전 예상 적립 개수 표시

### 권장 사항

**기본 제공:**
- 배수 적립 방식 (간단하고 이해하기 쉬움)

**고급 옵션:**
- 구간별 적립 방식 (파트너가 필요 시 선택)

**고객 안내:**
- 구간별 적립 사용 시 결제 전 예상 적립 개수 명확히 표시
- 구간 경계 안내 메시지 제공

---

## 출시 로드맵

| Phase | 기능 | 예상 출시일 |
|---|---|---|
| Phase 0 (현재) | 배수 적립 방식만 제공 | 런칭 시 |
| Phase 1 | 기본 구간별 적립 시스템 | 런칭 +18개월 |
| Phase 2 | 고급 구간별 적립 (차등 비율, 혜택 연동) | 런칭 +24개월 |

---

## 경쟁사 사례

### 스타벅스

- 현재: 배수 적립 (3,000원당 별 1개)
- 구간별 적립: 제공하지 않음
- 이유: 간단한 구조로 고객 이해도 높음

### 투썸플레이스

- 현재: 포인트 적립 (100원당 1점)
- 구간별 적립: 제공하지 않음
- 이유: 단순한 구조로 운영

**위드폼의 차별점:**
- 기본은 배수 적립 (간단함)
- 고급 옵션으로 구간별 적립 제공 (유연성)
- 파트너가 필요에 따라 선택 가능

---

## 참고

- 현재 구현: 배수 적립 방식 (`7-1-2-3. 리워드 정보 입력(선택 사항)\2.4. 스탬프 리워드 입력`)
- 구간별 적립 기능은 Phase 1에서 구현 예정
- 고객 경험을 고려하여 배수 적립을 기본으로 유지
