<!-- WF:DOC=DEV -->
**3.9.** 개발자 인터랙션 명세  


**3.9.1.** API 명세  


**3.9.1.1.** KPI 데이터 조회  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/kpi`  
　B. 인증: Bearer Token (파트너 세션)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | today \| week \| month \| last30 \| custom. 기본값: today |
| startDate | string | N | YYYY-MM-DD (preset=custom 시 필수) |
| endDate | string | N | YYYY-MM-DD (preset=custom 시 필수) |
| compareWithPreviousYear | boolean | N | true 시 전년 동기 대비 증감 포함. 기본값: false |

3: 응답 JSON  

```json
{
  "plan": "BASIC | PLUS | PREMIUM",
  "period": { "startDate": "YYYY-MM-DD", "endDate": "YYYY-MM-DD" },
  "kpis": [
    {
      "key": "visit | revisit | newCustomer | heavyUser | rewardIssued | rewardUsed | stampAccum | percentileSummary",
      "label": "string",
      "value": 0,
      "unit": "count | percent",
      "change": { "value": 0, "direction": "up | down | flat" },
      "yearOverYear": { "value": 0, "direction": "up | down | flat" }
    }
  ]
}
```

4: 응답 필드  
　A. kpis 배열: 플랜에 따라 3개(베이직)/6개(플러스)/8개(프리미엄) 반환(3.2. KPI 카드 영역 참조)  
　B. change: 선택 기간 대비 전 기간 증감  
　C. yearOverYear: compareWithPreviousYear=true 시에만 포함  

5: 에러  
　A. 401: 미인증  
　B. 403: 멤버십 미해당  
　C. STR_001: KPI 조회 실패  


**3.9.1.2.** 현황 - 추이 차트 데이터 조회(플러스 이상)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/trend`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| metric | string | Y | visit \| revisit \| rewardIssued \| rewardUsed \| stampAccum |
| unit | string | N | daily \| weekly \| monthly. 기본값: daily |
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |
| campaignId | string | N | 캠페인 단위 필터 시 지정 |

3: 응답 JSON  

```json
{
  "metric": "visit",
  "unit": "daily",
  "dataPoints": [
    { "date": "YYYY-MM-DD", "value": 0, "campaignActive": true }
  ]
}
```

4: 에러  
　A. 403: 플러스 미만 멤버십  
　B. STR_002: 추이 데이터 조회 실패  


**3.9.1.3.** 현황 - 메뉴·상품별 매출/주문 순위 조회(플러스 이상, 오더 이용 시)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/menu-ranking`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상, 오더 연동 매장)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |
| sortBy | string | N | orderCount \| revenue. 기본값: revenue |
| limit | number | N | 상위 N개, 기본값 10 |

3: 응답 JSON  

```json
{
  "items": [
    {
      "rank": 1,
      "menuId": "string",
      "menuName": "string",
      "orderCount": 0,
      "revenue": 0,
      "changeRate": 0.0
    }
  ],
  "period": { "startDate": "YYYY-MM-DD", "endDate": "YYYY-MM-DD" }
}
```

4: 응답 필드  
　A. changeRate: 전 기간 대비 등락률(%)  

5: 에러  
　A. 403: 플러스 미만 멤버십 또는 오더 미연동 매장  
　B. STR_003: 순위 조회 실패  


**3.9.1.4.** 현황 - 리워드 효율 분석 조회(플러스 이상)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/reward-efficiency`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |

3: 응답 JSON  

```json
{
  "coupon": {
    "issuedCount": 0,
    "usedCount": 0,
    "usageRate": 0.0,
    "withinExpiryUsageRate": 0.0
  },
  "stamp": {
    "accumCount": 0,
    "rewardExchangeCount": 0,
    "exchangeRate": 0.0,
    "avgDaysToExchange": 0
  },
  "point": {
    "issuedAmount": 0,
    "usedAmount": 0,
    "usageRate": 0.0
  },
  "overallROI": {
    "rewardCost": 0,
    "revisitIncrease": 0.0,
    "revenueIncrease": 0.0
  },
  "aiSuggestions": [
    { "type": "string", "message": "string", "priority": "high | medium | low" }
  ]
}
```

4: 응답 필드  
　A. overallROI: 리워드 비용 대비 재방문·매출 증가 효과(3.3.3.5. 참조)  
　B. aiSuggestions: 프리미엄 전용, AI 최적화 추천(플러스는 null)(3.3.4.6. 참조)  

5: 에러  
　A. 403: 플러스 미만 멤버십  
　B. STR_004: 효율 분석 조회 실패  


**3.9.1.5.** 현황 - 판매 유형별 분포 조회(플러스 이상)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/sales-type-distribution`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |
| campaignId | string | N | 캠페인 간 비교 시(프리미엄만) |

3: 응답 JSON  

```json
{
  "types": [
    {
      "type": "remote_order | qr_nfc | takeaway",
      "label": "string",
      "orderCount": 0,
      "revenue": 0,
      "ratio": 0.0
    }
  ],
  "notice": "위드폼 미경유 현장 직접 결제는 데이터 확보 불가"
}
```

4: 에러  
　A. 403: 플러스 미만 멤버십  
　B. STR_005: 분포 조회 실패  


**3.9.1.6.** 현황 - 매출 달력 조회(플러스 이상)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/sales-calendar`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| year | number | Y | 조회 연도 |
| month | number | Y | 조회 월(1~12) |

3: 응답 JSON  

```json
{
  "days": [
    {
      "date": "YYYY-MM-DD",
      "revenue": 0,
      "weather": { "icon": "sunny | cloudy | rainy | snowy", "tempHigh": 0, "tempLow": 0 },
      "memo": "string | null",
      "previousYearRevenue": 0
    }
  ],
  "weeklySummary": [
    { "weekNumber": 1, "totalRevenue": 0 }
  ]
}
```

4: 응답 필드  
　A. weather: 날씨 연동 데이터(3.3.3.7. 참조)  
　B. memo: 매장 이벤트·특이사항 메모  
　C. previousYearRevenue: 프리미엄 전용, 전년 동기 대비(플러스는 null)(3.3.4.8. 참조)  
　D. weeklySummary: 주간 합산 매출  

5: 에러  
　A. 403: 플러스 미만 멤버십  
　B. STR_006: 달력 조회 실패  


**3.9.1.7.** 현황 - 매출 달력 메모 저장(플러스 이상)  

1: 엔드포인트  
　A. `PUT /api/v1/partner/store/sales-calendar/memo`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 바디  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| date | string | Y | YYYY-MM-DD (메모 대상 날짜) |
| memo | string | Y | 메모 내용 (빈 문자열 시 메모 삭제) |

3: 응답  
　A. 성공: `{ "date": "YYYY-MM-DD", "memo": "string", "updatedAt": "YYYY-MM-DDTHH:mm:ss" }`  

4: 에러  
　A. 400: 유효하지 않은 날짜  
　B. 403: 플러스 미만 멤버십  
　C. STR_007: 메모 저장 실패  


**3.9.1.8.** 현황 - 시간대/요일 히트맵 조회(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/heatmap`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |
| viewMode | string | N | myStore \| benchmarkAvg \| diff. 기본값: myStore |

3: 응답 JSON  

```json
{
  "timeSlots": ["morning", "lunch", "afternoon", "evening"],
  "days": ["mon", "tue", "wed", "thu", "fri", "sat", "sun"],
  "cells": [
    { "timeSlot": "morning", "day": "mon", "value": 0, "benchmarkValue": 0, "diff": 0 }
  ]
}
```

4: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. STR_008: 히트맵 조회 실패  


**3.9.1.9.** 현황 - 고객 유형 분포 조회(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/customer-type-distribution`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |

3: 응답 JSON  

```json
{
  "segments": [
    {
      "type": "new | revisit | heavyUser",
      "count": 0,
      "ratio": 0.0,
      "change": { "value": 0, "direction": "up | down | flat" },
      "percentile": 0
    }
  ]
}
```

4: 응답 필드  
　A. change: 전 기간 대비 증감(3.3.4.2. 참조)  
　B. percentile: 비교군 대비 퍼센타일  

5: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. STR_009: 고객 분포 조회 실패  


**3.9.1.10.** 현황 - QR 스캔 분석 조회(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/qr-scan-analysis`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |
| viewMode | string | N | myStore \| benchmarkAvg \| diff |

3: 응답 JSON  

```json
{
  "hourlyHeatmap": [
    { "hour": 0, "scanCount": 0 }
  ],
  "dailyTrend": [
    { "day": "mon", "scanCount": 0 }
  ],
  "peakTime": { "hour": 12, "day": "fri" },
  "totalScans": 0
}
```

4: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. STR_010: QR 스캔 분석 조회 실패  


**3.9.1.11.** 현황 - 고객 등급별 매출 분포 조회(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/customer-grade-revenue`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |

3: 응답 JSON  

```json
{
  "grades": [
    {
      "grade": "new | revisit | heavyUser",
      "revenue": 0,
      "ratio": 0.0,
      "changeRate": 0.0
    }
  ]
}
```

4: 응답 필드  
　A. ratio: 전체 매출 대비 비중(파이/도넛 차트용)(3.3.4.9. 참조)  
　B. changeRate: 전 기간 대비 매출 변동률(%)  

5: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. STR_011: 매출 분포 조회 실패  


**3.9.1.12.** 벤치마크 - 비교군 목록 조회(플러스 이상)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/benchmark/groups`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 응답 JSON  

```json
{
  "groups": [
    {
      "groupId": "string",
      "name": "string",
      "type": "radius | sameDistrict | similar | custom",
      "storeCount": 0,
      "coverage": 0.0,
      "updatedAt": "YYYY-MM-DD",
      "isDefault": true,
      "isFavorite": false
    }
  ],
  "recommended": { "groupId": "string", "name": "string" }
}
```

3: 응답 필드  
　A. type: 비교 방식(반경/타지역 동일 상권/유사 매장/사용자 지정)(3.4.3.3. 참조)  
　B. coverage: 데이터 커버리지(%)  
　C. recommended: 추천 비교군  

4: 에러  
　A. 403: 플러스 미만 멤버십  
　B. BM_001: 비교군 목록 조회 실패  


**3.9.1.13.** 벤치마크 - 비교군 설정·저장(플러스 이상)  

1: 엔드포인트  
　A. `POST /api/v1/partner/store/benchmark/groups`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 바디  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| name | string | Y | 비교군 이름 |
| type | string | Y | radius \| sameDistrict \| similar \| custom |
| radiusKm | number | N | type=radius 시 반경(km) |
| districtCode | string | N | type=sameDistrict 시 상권 코드 |
| filters | object | N | 프로필 필터(업종·규모·매출 범위 등) |
| isDefault | boolean | N | 기본 비교군 설정 여부 |
| isFavorite | boolean | N | 즐겨찾기 여부 |

3: 응답  
　A. 성공: `{ "groupId": "string", "name": "string", "storeCount": 0, "coverage": 0.0 }`  
　B. 400: 표본 부족(storeCount < 최소 기준)  

4: 에러  
　A. 403: 플러스 미만 멤버십  
　B. BM_002: 비교군 설정 실패  
　C. BM_003: 표본 부족 경고  

5: 접근성  
　A. 저장 버튼: aria-label="비교군 저장"  


**3.9.1.14.** 벤치마크 - 결과 조회(플러스 이상)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/benchmark/result`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| groupId | string | Y | 비교군 ID |
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |
| layer | string | N | basic \| advanced(프리미엄). 기본값: basic |

3: 응답 JSON  

```json
{
  "groupInfo": { "groupId": "string", "name": "string", "storeCount": 0 },
  "metrics": [
    {
      "key": "visit | revisit | rewardIssued | rewardUsed | stampAccum",
      "myValue": 0,
      "benchmarkAvg": 0,
      "ratio": 0.0,
      "statusLabel": "우수 | 양호 | 보통 | 미흡",
      "causeHint": "string | null",
      "percentile": 0,
      "rank": "상위 10%"
    }
  ]
}
```

4: 응답 필드  
　A. ratio: 내 매장 / 비교군 평균 비율(3.4.3.2. 참조)  
　B. causeHint: 원인 힌트(미흡 이하 시)  
　C. percentile, rank: 프리미엄 전용(플러스는 null)(3.4.4.2. 참조)  

5: 에러  
　A. 403: 플러스 미만 멤버십  
　B. 404: groupId 없음  
　C. BM_004: 결과 조회 실패  


**3.9.1.15.** 벤치마크 - QR 스캔율 벤치마크 조회(플러스 이상)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/benchmark/qr-scan-rate`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| campaignId | string | N | 특정 캠페인 기준 비교 |
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |

3: 응답 JSON  

```json
{
  "myScanRate": 0.0,
  "avgScanRate": 0.0,
  "myRank": "상위 15%",
  "distribution": [
    { "rangeLabel": "0~20%", "storeCount": 0 }
  ]
}
```

4: 에러  
　A. 403: 플러스 미만 멤버십  
　B. BM_005: QR 스캔율 벤치마크 조회 실패  


**3.9.1.16.** 벤치마크 - 퍼센타일·랭킹 조회(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/benchmark/percentile`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| groupId | string | Y | 비교군 ID |
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |

3: 응답 JSON  

```json
{
  "metrics": [
    {
      "key": "string",
      "percentile": 85,
      "rank": "상위 15%",
      "myValue": 0,
      "benchmarkAvg": 0,
      "ratio": 0.0
    }
  ]
}
```

4: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. BM_006: 퍼센타일 조회 실패  


**3.9.1.17.** 인사이트 - 인사이트 카드 조회(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/insights`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |

3: 응답 JSON  

```json
{
  "cards": [
    {
      "insightId": "string",
      "conditionLabel": "평일+오전 | 주말+저녁 | 신규 | 재방문 | 헤비유저",
      "message": "string",
      "evidence": { "comparison": "string", "percentile": 0 },
      "actions": [
        { "type": "targetSelect | automationSetup | createPoster", "label": "string", "targetRoute": "string" }
      ]
    }
  ],
  "dormantAlert": {
    "count": 0,
    "message": "휴면 고객 N명 증가",
    "linkTo": "/partner/membership/customer-management"
  }
}
```

4: 응답 필드  
　A. conditionLabel: 세분화 조건 라벨(3.5.4.1. 참조)  
　B. evidence: 근거(% 비교·퍼센타일)  
　C. actions: 실행 버튼(타겟 선택/자동화 설정/포스터 만들기)  
　D. dormantAlert: 휴면 고객 증가 인사이트 + 고객 관리 바로가기(3.5.4.2., 7-2-6-2 > 2.2.4. 참조)  

5: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. INS_001: 인사이트 조회 실패  


**3.9.1.18.** 인사이트 - 타겟팅 알림톡 시나리오 관리(프리미엄)  

1: 조회 엔드포인트  
　A. `GET /api/v1/partner/store/automation/scenarios`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 조회 응답 JSON  

```json
{
  "scenarios": [
    {
      "scenarioId": "string",
      "name": "우수 고객 감사 | 이탈 위험 알림 | 신규 환영",
      "isActive": true,
      "targetCount": 0,
      "sentThisMonth": 0,
      "maxPerMonth": 300,
      "lastTriggeredAt": "YYYY-MM-DDTHH:mm:ss"
    }
  ],
  "monthlyUsage": { "sent": 0, "remaining": 300 }
}
```

3: 설정 엔드포인트  
　A. `PUT /api/v1/partner/store/automation/scenarios/{scenarioId}`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

4: 설정 요청 바디  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| isActive | boolean | Y | 활성화 여부 |
| templateId | string | N | 메시지 템플릿 ID |
| targetCondition | object | N | 타겟 조건(방문 빈도·결제 범위 등) |
| safetyLimit | number | N | 월 최대 발송 건수 제한 |

5: 설정 응답  
　A. 성공: `{ "scenarioId": "string", "isActive": true, "updatedAt": "YYYY-MM-DDTHH:mm:ss" }`  

6: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. INS_002: 시나리오 조회/설정 실패  
　C. INS_003: 월 발송 한도 초과  

7: 접근성  
　A. 시나리오 토글: aria-label="시나리오 활성화/비활성화"  


**3.9.1.19.** 인사이트 - 수동 스탬프 고급 리포트 조회(플러스 이상)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/stamp-report`  
　B. 인증: Bearer Token (파트너 세션, 플러스 이상)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |
| unit | string | N | daily \| weekly \| monthly |

3: 응답 JSON  

```json
{
  "dailySummary": { "totalStamps": 0, "avgPerDay": 0.0 },
  "anomalies": [
    {
      "date": "YYYY-MM-DD",
      "type": "spike | unusual_time | unusual_count",
      "description": "string",
      "severity": "warning | critical"
    }
  ],
  "staffComparison": [
    { "staffId": "string", "staffName": "string", "stampCount": 0, "anomalyCount": 0 }
  ],
  "anomalyHistory": [
    { "date": "YYYY-MM-DD", "type": "string", "resolved": true }
  ],
  "autoInsight": "string",
  "improvementSuggestion": "string"
}
```

4: 응답 필드  
　A. anomalies: 이상 패턴 경고(3.5.4.4. 참조)  
　B. staffComparison: 직원별 비교(프리미엄 전용, 플러스는 null)  
　C. autoInsight, improvementSuggestion: 프리미엄 전용 자동 인사이트·개선 제안  

5: 에러  
　A. 403: 플러스 미만 멤버십  
　B. INS_004: 스탬프 리포트 조회 실패  


**3.9.1.20.** 인사이트 - 종합 리포트 목록 조회(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/comprehensive-reports`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 응답 JSON  

```json
{
  "reports": [
    {
      "reportId": "string",
      "type": "monthly | quarterly | annual",
      "period": "2026-01 | 2026-Q1 | 2025",
      "generatedAt": "YYYY-MM-DDTHH:mm:ss",
      "status": "ready | generating | failed"
    }
  ]
}
```

3: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. INS_005: 리포트 목록 조회 실패  


**3.9.1.21.** 인사이트 - 종합 리포트 다운로드(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/comprehensive-reports/{reportId}/download`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 응답  
　A. 성공: 바이너리 스트림(PDF, Content-Disposition: attachment)  
　B. 404: reportId 없음 또는 생성 중  

3: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. INS_006: 다운로드 실패  

4: 접근성  
　A. 다운로드 버튼: aria-label="종합 리포트 다운로드"  


**3.9.1.22.** 인사이트 - CLV 예측 데이터 조회(프리미엄)  

1: 엔드포인트  
　A. `GET /api/v1/partner/store/clv`  
　B. 인증: Bearer Token (파트너 세션, 프리미엄)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| preset | string | N | 기간 프리셋 |
| startDate | string | N | YYYY-MM-DD |
| endDate | string | N | YYYY-MM-DD |

3: 응답 JSON  

```json
{
  "segments": [
    {
      "segment": "highValue | atRisk | growthPotential",
      "label": "고가치 | 이탈 위험 | 성장 잠재",
      "customerCount": 0,
      "avgCLV": 0,
      "suggestions": [
        { "type": "alimtalk | reward | coupon", "message": "string" }
      ]
    }
  ],
  "trendChart": [
    {
      "period": "YYYY-MM",
      "highValueCount": 0,
      "atRiskCount": 0,
      "growthPotentialCount": 0
    }
  ]
}
```

4: 응답 필드  
　A. segments: 세그먼트별 고객 수·평균 CLV·맞춤 실행 제안(3.5.4.6. 참조)  
　B. trendChart: 기간별 세그먼트 변화 시각화 데이터  

5: 에러  
　A. 403: 프리미엄 미만 멤버십  
　B. INS_007: CLV 조회 실패  


**3.9.1.23.** 캠페인 결과 리포트 다운로드  

1: 엔드포인트  
　A. `GET /api/v1/partner/campaign/report/{campaignId}/download`  
　B. 인증: Bearer Token (파트너 세션)  

2: 요청 쿼리 파라미터  

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| format | string | Y | pdf \| excel. pdf=요약(전체 파트너), excel=상세(멤버십 플러스 이상) |

3: 응답  
　A. 성공: 바이너리 스트림(Content-Disposition: attachment, 파일명 포함)  
　B. 403: excel 요청 시 플러스 미만 멤버십  
　C. 404: campaignId 없음 또는 해당 파트너 캠페인 아님  

4: 에러  
　A. RPT_001: 리포트 조회 실패  
　B. RPT_002: 다운로드 실패  

5: 접근성  
　A. 다운로드 버튼: aria-label="캠페인 결과 리포트 다운로드"  


**3.9.2.** 매장 관리 데이터 조회(참고)  

**3.9.2.1.** 연동 범위  

1: KPI·현황·벤치마크·인사이트 데이터는 기간·플랜에 따라 기존 파트너 대시보드·리포트·벤치마크 API 등과 연동  
2: 기간 파라미터: startDate, endDate 또는 preset(today/week/month/last30/custom), compareWithPreviousYear(전년 동기 대비 시 true)  
3: 플랜별 노출 제어: 클라이언트에서 현재 멤버십( GET /api/v1/partner/membership/current ) 기준으로 탭·위젯·다운로드 형식·잠금 영역 제한 적용  
4: 메뉴·상품별 매출/주문 순위(플러스·프리미엄, 오더 이용 시): 기존 주문/메뉴 API와 연동, 기간·정렬 파라미터 적용  


**3.9.3.** 데이터 품질·커버리지(내부용)  

**3.9.3.1.** 관리 방식  

1: 데이터 커버리지(수집 상태)는 파트너 사용자 화면에 배지로 노출하지 않음(3.0.4.2. 데이터 커버리지, 3.1. 상단 고정 영역 참조)  
2: 내부·관리자·개발자용: 기간별 데이터 수집 완전도(오더/리워드/캠페인 소진 등)를 산출하여 "데이터 미수집" 라벨·미수집 사유 노출 여부, 벤치마크 표본 품질 판단 등에 사용  
3: 클라이언트는 지표별 null/미제공 시 3.7. 하단 CTA·예외·잠금의 "데이터 부분 누락" UX 적용(라벨·사유 문구는 API 또는 정책에서 제공)  


**3.9.4.** 컴포넌트 구현 참고  

**3.9.4.1.** 기간 필터  

1: 선택한 기간(preset 또는 startDate/endDate)을 상태·쿼리로 보관  
2: 기간 변경 시 KPI·현황·벤치마크·인사이트 관련 API에 동일 기간 파라미터 전달하여 갱신  
3: 전년 동기 대비 옵션 시 compareWithPreviousYear 또는 동일 기간 전년 start/end 전달  


**3.9.4.2.** KPI 카드 클릭  

1: 카드 클릭 시 현황 탭 내 해당 지표 블록으로 스크롤 이동(해당 섹션 DOM ID 기반)(3.8.1.2. 참조)  
2: 포커스 또는 펼치기 처리  


**3.9.4.3.** 탭 전환  

1: 현황/벤치마크/인사이트·실행 중 선택 시 해당 탭 본문만 표시(3.8.1.3. 참조)  
2: 기간·플랜 조건 유지, 탭 변경 시 탭별 데이터 API 호출(미로드 시) 또는 캐시 활용  
3: 플랜 잠금 탭 진입 시 미리보기 + 잠금 오버레이 + 업그레이드 CTA 즉시 표시  


**3.9.4.4.** 이상치/주의 알림(베이직)  

1: 알림 데이터는 KPI API 응답 또는 별도 알림 이벤트로 수신(3.3.2.3. 참조)  
2: 알림 클릭 시 유형별 이동 대상 결정(캠페인 상세, 리워드 설정, 소진 보고 입력 등)(3.8.1.4. 참조)  
3: 최대 3개 표시, 우선순위에 따라 정렬  


**3.9.4.5.** 벤치마크 비교군 설정 드로어  

1: 5단계 프로세스: 방식 선택 → 범위 설정 → 필터 적용 → 미리보기(표본 수·커버리지) → 적용/저장(3.4.3.3. 참조)  
2: 표본 부족 시(storeCount < 최소 기준) 경고 표시 + 범위 확장/필터 완화 버튼 제공(3.7.2.3. 참조)  
3: 저장 시 POST /api/v1/partner/store/benchmark/groups 호출(3.9.1.13. 참조)  
4: 적용 시 벤치마크 결과 API 재호출(3.9.1.14. 참조)  


**3.9.4.6.** 플랜별 잠금·미리보기 상태 관리  

1: 클라이언트는 GET /api/v1/partner/membership/current 응답의 plan 값 기준으로 잠금 영역 결정(3.7.3. 참조)  
2: 베이직: 벤치마크 탭 + 인사이트·실행 탭 전체 잠금/미리보기  
3: 플러스: 인사이트·실행 탭 고급 기능(알림톡 자동화·포스터 AI·종합 리포트·CLV 예측 등) 잠금/미리보기  
4: 잠금 영역 렌더링: 콘텐츠 블러/마스킹 + "○○에서 제공" 라벨 + 업그레이드 CTA  


**3.9.4.7.** CTA  

1: 업그레이드 CTA: /partner/membership/subscribe?plan=PLUS|PREMIUM 등으로 이동(3.8.3.1. 참조)  
2: 포스터 만들기: 7-2-17-2 매장 포스터 AI 생성 라우트로 이동  
3: 자동화 설정: 인사이트·실행 탭 내 타겟팅 알림톡 자동화 위젯으로 스크롤  


**3.9.4.8.** 캠페인 리포트 다운로드  

1: [다운로드] 클릭 → format 선택 → 3.9.1.23. API 호출 후 blob 저장(3.6.2. 참조)  
2: excel 선택 시 멤버십 플러스 미만이면 403 처리 후 업그레이드 안내 표시  


**3.9.4.9.** 매출 달력 메모  

1: 달력 날짜 클릭 → 메모 입력 영역 노출(3.3.3.7. 참조)  
2: 저장 시 PUT /api/v1/partner/store/sales-calendar/memo 호출(3.9.1.7. 참조)  
3: 빈 문자열 저장 시 메모 삭제  


• 참조: 7-2-6-3. 매장 관리 > 3.0. 페이지 개요, 3.1. 상단 고정 영역 ~ 3.7. 하단 CTA·예외·잠금, 3.6. 캠페인 결과 및 다운로드, 3.8. 액션 버튼 및 화면 전환  
