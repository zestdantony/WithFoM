**3.7.** 개발자 인터랙션 명세  


**3.7.1.** 데이터 연동  

**3.7.1.1.** REST API 기반  
1: 데이터 조회 방식  
　A. 대시섹션 로드 시 소진 보고 현황 API 호출  
　B. 단일 캠페인만 조회 (복수 캠페인 동시 참여 불가)  
2: 실시간 업데이트  
　A. 소진 보고는 실시간성이 낮아 WebSocket 불필요  
　B. 페이지 리로드 또는 수동 새로고침으로 갱신  


**3.7.2.** API 명세  

**3.7.2.1.** 소진 보고 현황 조회 (대시섹션용)  
1: 엔드포인트  
　A. GET /api/v1/partner/campaigns/consumption/dashboard  
2: 요청 파라미터  
　A. date (optional): 조회 기준일 (기본값: 오늘)  
3: 응답 구조  

```json
{
  "campaignMatching": {
    "isMatched": true,
    "status": "active",
    "nextMatchingDate": null
  },
  "currentCampaign": {
    "campaignId": "CMP-2026-001234",
    "campaignName": "OO브랜드 신제품 런칭 캠페인",
    "campaignPeriod": {
      "startDate": "2026-01-15",
      "endDate": "2026-02-14"
    },
    "round": 3,
    "statistics": {
      "totalAllocated": 3000,
      "totalConsumed": 1847,
      "remaining": 1153,
      "dailyAverage": 118,
      "daysRemaining": 12
    }
  },
  "dateInfo": {
    "today": {
      "date": "2026-01-28",
      "dayOfWeek": "수",
      "displayText": "2026년 1월 28일 (수)"
    },
    "yesterday": {
      "date": "2026-01-27",
      "dayOfWeek": "화",
      "displayText": "2026년 1월 27일 (화)"
    }
  },
  "todayReport": {
    "status": "pending",
    "value": null,
    "reportedAt": null,
    "isHoliday": false,
    "holidayAutoProcessed": false
  },
  "yesterdayReport": {
    "status": "pending",
    "value": null,
    "reportedAt": null,
    "canModify": true,
    "modifyDeadline": "2026-01-28T11:00:00Z",
    "remainingTime": {
      "hours": 1,
      "minutes": 23
    },
    "isHoliday": false,
    "holidayAutoProcessed": false
  },
  "sectionStatus": {
    "isActive": true,
    "showYesterdayCard": true,
    "yesterdayInputEnabled": true,
    "todayInputEnabled": false,
    "statusBadge": {
      "text": "보고 필요",
      "color": "red"
    }
  },
  "businessHours": {
    "is24Hours": false,
    "openTime": "09:00",
    "modifyDeadlineHours": 2
  }
}
```


**3.7.2.2.** 소진량 보고 제출  
1: 엔드포인트  
　A. POST /api/v1/partner/campaigns/{campaignId}/consumption  
2: 요청 바디  

```json
{
  "date": "2026-01-28",
  "consumptionCount": 142,
  "confirmedWarning": false
}
```

3: 응답 구조  

```json
{
  "success": true,
  "campaignId": "CMP-2026-001234",
  "date": "2026-01-28",
  "consumptionCount": 142,
  "reportedAt": "2026-01-28T22:40:00Z",
  "warning": {
    "triggered": true,
    "type": "above_average",
    "message": "입력값이 평균(118개) 대비 1.2배입니다."
  },
  "statistics": {
    "totalConsumed": 1989,
    "remaining": 1011,
    "dailyAverage": 120
  }
}
```


**3.7.2.3.** 소진량 수정  
1: 엔드포인트  
　A. PUT /api/v1/partner/campaigns/{campaignId}/consumption/{date}  
2: 요청 바디  

```json
{
  "consumptionCount": 130,
  "modifyReason": "입력 실수 수정"
}
```

3: 응답 구조  

```json
{
  "success": true,
  "campaignId": "CMP-2026-001234",
  "date": "2026-01-27",
  "previousValue": 127,
  "newValue": 130,
  "modifiedAt": "2026-01-28T09:15:00Z",
  "modifyHistory": {
    "previousValue": 127,
    "newValue": 130,
    "modifiedAt": "2026-01-28T09:15:00Z",
    "modifiedBy": "partner_user_id"
  }
}
```


**3.7.2.4.** 수정 가능 여부 확인  
1: 엔드포인트  
　A. GET /api/v1/partner/campaigns/{campaignId}/consumption/{date}/can-modify  
2: 응답 구조  

```json
{
  "canModify": true,
  "deadline": "2026-01-29T11:00:00Z",
  "remainingTime": {
    "hours": 1,
    "minutes": 45
  },
  "reason": null
}
```


**3.7.3.** 컴포넌트 상태 관리  

**3.7.3.1.** 보고 상태 정의  
1: 보고 상태 (reportStatus)  
　A. pending: 보고 필요 (미완료)  
　B. reported: 보고 완료  
　C. holiday: 휴무일 (자동 0개 처리)  
　D. modified: 수정됨  
　E. expired: 입력 마감 (시간 초과)  
2: UI 상태 (uiState)  
　A. idle: 기본 상태  
　B. inputting: 입력 중  
　C. submitting: 제출 처리 중  
　D. editing: 수정 모드  
　E. success: 제출 성공  
　F. error: 제출 실패  

**3.7.3.2.** 상태별 뱃지 정의  
1: 뱃지 데이터  
　A. pending: { text: "보고 필요", color: "red", icon: "alert" }  
　B. reported: { text: "보고 완료", color: "green", icon: "check" }  
　C. holiday: { text: "휴무일", color: "gray", icon: "calendar" }  
　D. expired: { text: "입력 마감", color: "red", icon: "lock" }  
　E. waiting: { text: "매칭 대기", color: "gray", icon: "clock" } // 매칭 전에만 표시, 매칭 확정 시 일반 상태로 전환  


**3.7.4.** 입력 검증 로직  

**3.7.4.1.** 클라이언트 검증  
1: 입력값 검증  

```javascript
const validateConsumption = (value, dailyAverage) => {
  // 숫자 형식 검증
  if (!/^\d+$/.test(value)) {
    return { valid: false, error: '숫자만 입력 가능합니다' };
  }
  
  const numValue = parseInt(value, 10);
  
  // 범위 검증
  if (numValue < 0 || numValue > 99999) {
    return { valid: false, error: '0 ~ 99,999 범위에서 입력해 주세요' };
  }
  
  // 평균 대비 경고 체크
  if (dailyAverage > 0) {
    const ratio = numValue / dailyAverage;
    if (ratio >= 1.5 || ratio <= 0.5) {
      return { 
        valid: true, 
        warning: true, 
        message: `입력값이 평균(${dailyAverage}개) 대비 ${ratio.toFixed(1)}배입니다.` 
      };
    }
  }
  
  // 0 입력 확인
  if (numValue === 0) {
    return { valid: true, confirmZero: true };
  }
  
  return { valid: true };
};
```


**3.7.5.** 에러 처리  

**3.7.5.1.** 에러 코드 정의  
1: 에러 코드  
　A. CSM_001: 이미 보고 완료된 날짜  
　B. CSM_002: 수정 가능 시간 초과  
　C. CSM_003: 캠페인이 종료됨  
　D. CSM_004: 잘못된 입력값  
　E. CSM_005: 권한 없음  

**3.7.5.2.** 에러 처리 방식  
1: API 호출 실패  
　A. 재시도 버튼 표시  
　B. 토스트: "제출에 실패했습니다. 다시 시도해 주세요."  
　C. 자동 재시도: 3회, 간격 2초  
2: 비즈니스 에러  
　A. CSM_001: "이미 오늘 보고가 완료되었습니다." 토스트  
　B. CSM_002: 수정 불가 팝업 표시  


**3.7.6.** 알림 연동  

**3.7.6.1.** 미보고 알림 트리거  
1: 서버 측 스케줄러  
　A. 영업 종료 후 1시간: 1차 알림 발송  
　B. 익일 오전 10시: 2차 알림 발송  
　C. 연속 3일 미보고: 경고 알림 발송  
2: 알림 페이로드  

```json
{
  "type": "consumption_reminder",
  "level": "warning",
  "title": "소진 보고 필요",
  "body": "어제 소진 보고가 완료되지 않았습니다. 소진 보고를 완료해 주세요.",
  "action": {
    "type": "deeplink",
    "target": "/partner/campaigns/consumption"
  },
  "meta": {
    "campaignId": "CMP-2026-001234",
    "missedDate": "2026-01-27"
  }
}
```


**3.7.7.** 접근성 요구사항  

**3.7.7.1.** ARIA 레이블  
1: 섹션 영역  
　A. role="region"  
　B. aria-label="일일 소진 보고 섹션"  
2: 입력 필드  
　A. aria-label="오늘 소진량 입력"  
　B. aria-describedby="consumption-help" (도움말 연결)  
　C. aria-invalid="true" (검증 실패 시)  
3: 버튼  
　A. aria-label="소진량 제출"  
　B. aria-busy="true" (처리 중)  
　C. aria-disabled="true" (비활성화 시)  
4: 상태 뱃지  
　A. aria-live="polite" (상태 변경 알림)  
　B. aria-label="보고 상태: {상태}"  

**3.7.7.2.** 키섹션 내비게이션  
1: Tab 순서  
　A. 섹션 제목 → 상세 보기 링크 → 캠페인 선택 → 입력 필드 → 제출 버튼  
2: 단축키  
　A. Enter: 제출 버튼 클릭 (입력 필드 포커스 시)  
　B. Escape: 팝업 닫기  


**3.7.8.** 성능 최적화  

**3.7.8.1.** 렌더링 최적화  
1: 컴포넌트 구조  
　A. React.memo 또는 shouldComponentUpdate 적용  
　B. 캠페인 선택 변경 시에만 데이터 영역 리렌더링  
2: 입력 필드  
　A. debounce 적용 (300ms) - 입력값 검증 시  
　B. 즉각적인 UI 피드백 유지  

**3.7.8.2.** 데이터 캐싱  
1: 캐싱 전략  
　A. 소진 보고 현황: 페이지 로드 시 1회 조회  
　B. 제출 완료 후 로컬 상태 업데이트  
　C. 다음 페이지 방문 시 재조회  


• 참조: 7-2-5-1. 캠페인 소진 보고 > 개발자 명세
