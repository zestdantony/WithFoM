<!-- WF:DOC=BIZ -->
**2.2.** 코인 구매 모달  


**2.2.1.** 모달 구성  


**2.2.1.1.** 구매 정보 안내  

1: 단가 안내  
　A. 폼 코인 1개 = 10원  
　B. 최소 구매 단위: 1,000개(10,000원)  
　C. 유효기간: 구매일로부터 1년  


**2.2.1.2.** 수량 선택  

1: 선택 방법  
　A. 빠른 선택 버튼: 1,000개 / 2,000개 / 5,000개 / 10,000개  
　B. 직접 입력: 1,000개 단위로 입력  
　C. 결제 금액 실시간 표시  


**2.2.1.3.** 결제 수단 선택  

1: 결제 방법  
　A. 등록된 카드 목록 표시  
　B. 새 카드 등록 옵션  
　C. 계좌이체 옵션(사업자)  


**2.2.2.** 결제 처리  


**2.2.2.1.** 결제 버튼  

1: 결제 진행  
　A. [결제하기] 버튼 클릭  
　B. 결제 진행 중 로딩 표시  


**2.2.2.2.** 결제 완료  

1: 성공 처리  
　A. "폼 코인 [N]개가 충전되었습니다!" 메시지  
　B. 코인 현황(2.1.) 즉시 갱신  
　C. 결제 증빙 자동 발행  


**2.2.2.3.** 결제 실패  

1: 실패 처리  
　A. 실패 사유 표시(카드 한도, 네트워크 오류 등)  
　B. 재시도 또는 다른 결제 수단 안내  


**2.2.3.** 결제 안전장치  


**2.2.3.1.** 이중 결제 방지  

1: 버튼 제어  
　A. [결제하기] 클릭 즉시 버튼 비활성화 + 로딩 스피너  

2: 이탈 방지  
　A. 결제 진행 중 모달 닫기/새로고침 시 경고: "결제가 진행 중입니다. 이탈 시 결제가 중복될 수 있습니다."  

3: 서버 중복 차단  
　A. 클라이언트 측 idempotency key 생성 → 서버에서 동일 key 중복 요청 차단  


**2.2.3.2.** 결제 성공 후 반영 실패  

1: 비동기 복구  
　A. PG 결제 성공 → 서버 코인 적립 API 실패 시 클라이언트 안내: "결제는 완료되었으나 코인 반영에 실패했습니다. 자동 복구를 시도합니다."  
　B. 서버: PG 웹훅 기반 비동기 복구 → 최대 5분 내 자동 반영  
　C. 5분 초과 미반영 시 고객센터 안내 + 결제 건 자동 알림 발송  


**2.2.3.3.** 최대 보유 한도  

1: 한도 제한  
　A. 파트너 1매장 당 최대 보유 코인: 100,000개(1,000,000원 상당)  
　B. 한도 초과 구매 시도 시: "최대 보유 한도를 초과합니다. 현재 보유: N개 / 추가 구매 가능: M개"  


**2.2.3.4.** 환불 정책  

1: 환불 조건  
　A. 미사용 코인 환불 가능(구매일로부터 7일 이내, 사용 이력 없는 건에 한함)  
　B. 게임 적립 완료된 코인은 적립 해제 후 환불 가능  

2: 환불 절차  
　A. 코인 내역(2.3.) > 해당 구매 건 > [환불 요청] 버튼 → 확인 모달  
　B. 환불 처리 기간: 영업일 3~5일  


**2.2.4.** 세금 및 증빙  


**2.2.4.1.** 결제 증빙  

1: 증빙 유형  
　A. 사업자 파트너: 전자세금계산서 자동 발행(사업자 등록번호 기반)  
　B. 일반 파트너: 현금영수증 또는 카드 매출전표  

2: 증빙 조회  
　A. 코인 내역(2.3.) > 해당 구매 건 > [증빙 보기] 버튼  


• 참조: 2.1. 코인 현황 섹션, 2.3. 코인 내역 섹션, 3-7-1 > 5. 코인 시스템  
