<!-- WF:DOC=DEV -->
**2.1.3.** 개발자 인터랙션 명세  


**2.1.3.1.** 나의 등급 조회 API  

1: 엔드포인트  
　A. GET /api/v1/partner/grade/my-status  

2: 요청 파라미터  
　A. partnerId: 파트너 ID (JWT에서 자동 추출)  

3: 응답 구조  

```json
{
  "partnerId": "PTN-001",
  "currentGrade": {
    "grade": "gold",
    "gradeName": "골드",
    "gradeIcon": "🥇",
    "gradeColor": "#FFD700",
    "since": "2025-07-01T00:00:00Z",
    "validUntil": "2026-06-30T23:59:59Z"
  },
  "score": {
    "total": 64,
    "nextGrade": {
      "grade": "platinum",
      "requiredScore": 73,
      "gap": 9
    },
    "assessmentStartDate": "2025-01-01",
    "elapsedDays": 182,
    "usagePeriod": {
      "actualDays": 142,
      "requiredDays": 180,
      "progressPercent": 78.9
    }
  },
  "benefits": {
    "cupholder": {
      "type": "무료 제공",
      "applied": true,
      "campaignActive": true
    },
    "membership": {
      "type": "30% 할인",
      "applied": true,
      "subscribedPlan": "plus",
      "originalPrice": 29000,
      "discountedPrice": 20300
    },
    "incentive": null
  },
  "matching": {
    "gradeScore": 3,
    "gradeLabel": "우선",
    "membershipScore": 2,
    "membershipLabel": "일반",
    "totalScore": 5,
    "matchingTier": "우선 매칭"
  },
  "unmatchedStatus": {
    "isUnmatched": true,
    "lastCampaignEndDate": "2025-01-15",
    "unmatchedDays": 45,
    "downgradeDate": "2025-07-15",
    "daysUntilDowngrade": 135,
    "warningLevel": null,
    "alerts": {
      "firstWarning": { "sent": false, "triggerDate": "2025-04-15" },
      "finalWarning": { "sent": false, "triggerDate": "2025-06-08" }
    }
  },
  "membershipStatus": {
    "plan": "plus",
    "planName": "플러스",
    "isSubscribed": true,
    "isPremium": false
  }
}
```


**2.1.3.2.** 컴포넌트 상태 관리  

1: 로딩 상태 (loadingState)  
　A. loading: 데이터 로딩 중  
　B. ready: 데이터 로드 완료  
　C. error: 에러 발생  

2: CTA 분기 로직 (ctaState)  
　A. 미매칭 사전 알림 및 등급 변경 알림 CTA  

```javascript
function getAlertCTA(membershipStatus, currentGrade, alertType) {
  // 미매칭 사전 알림 CTA
  if (alertType === 'unmatched_warning') {
    if (membershipStatus.plan === 'basic') {
      return { text: '매칭 확률 UP', target: '/partner/membership/subscribe' };
    }
    if (membershipStatus.plan === 'plus') {
      return { text: '프리미엄으로 매칭 확률 UP', target: '/partner/membership/upgrade' };
    }
    if (membershipStatus.plan === 'premium' && currentGrade === 'platinum') {
      return { text: '매칭 시까지 등급이 유지됩니다', target: null }; // 정보성 안내, CTA 없음
    }
    if (membershipStatus.plan === 'premium') {
      return { text: '등급 UP으로 매칭 확률 UP', target: '/partner/grade/status' };
    }
  }
  // 등급 변경(다운그레이드) 완료 알림 CTA
  if (alertType === 'downgrade') {
    if (membershipStatus.plan === 'basic') {
      return { text: '매칭 확률 UP', target: '/partner/membership/subscribe' };
    }
    if (membershipStatus.plan === 'plus') {
      return { text: '프리미엄으로 매칭 확률 UP', target: '/partner/membership/upgrade' };
    }
    if (membershipStatus.plan === 'premium') {
      return { text: '등급 현황 보기', target: '/partner/grade/status' };
    }
  }
}
```

3: 멤버십 구독 버튼 표시 로직 (membershipButtonState)  

```javascript
function showMembershipButton(currentGrade, membershipStatus) {
  // 골드/플래티넘이면서 프리미엄 미구독인 경우에만 표시
  const isGoldOrAbove = ['gold', 'platinum'].includes(currentGrade);
  const isNotPremium = membershipStatus.plan !== 'premium';
  return isGoldOrAbove && isNotPremium;
}
```


**2.1.3.3.** 실시간 데이터 연동  

1: WebSocket 이벤트  
　A. grade.current_updated: 현재 등급 정보 갱신  
　B. grade.score_changed: 등급 점수 변동  
　C. grade.warning: 등급 변경 위험 경고  
　D. grade.unmatched_warning: 미매칭 경고 알림 (3개월, 5개월 3주차)  
　E. grade.downgrade: 등급 변경(다운) 적용 알림  
　F. grade.campaign_matched: 캠페인 매칭 완료 (등급 유지 확정)  
　G. grade.recalculated: 캠페인 종료 후 등급 재산정 완료  

2: 연결 정보  
　A. 엔드포인트: wss://api.withfom.com/partner/grade/status/realtime  
　B. 인증: JWT 토큰 기반 연결  

3: 이벤트 페이로드  

```json
// grade.unmatched_warning (1차 알림 - 3개월 경과)
{
  "type": "unmatched_warning",
  "warningLevel": "first",
  "unmatchedDays": 90,
  "daysUntilDowngrade": 90,
  "currentGrade": "gold",
  "targetGrade": "silver",
  "title": "등급 유지 안내",
  "message": "마지막 캠페인 종료 후 3개월이 지났습니다. 골드 등급 유지를 위해 새로운 캠페인에 참여가 시급합니다. (미참여 시 실버로 조정)",
  "cta": "멤버십 상태별 분기 (2.1.3.2. > 2: CTA 분기 로직 참조)",
  "channels": { "push": true, "inApp": true, "email": true }
}

// grade.unmatched_warning (최종 알림 - 5개월 3주차)
{
  "type": "unmatched_warning",
  "warningLevel": "final",
  "unmatchedDays": 173,
  "daysUntilDowngrade": 7,
  "currentGrade": "gold",
  "targetGrade": "silver",
  "title": "[최종 알림] 등급 조정 예정",
  "message": "등급 조정까지 7일 남았습니다. 골드 등급과 혜택을 유지하기 위해 새 캠페인 참여가 시급합니다. (미참여 시 실버로 조정)",
  "cta": "멤버십 상태별 분기 (2.1.3.2. > 2: CTA 분기 로직 참조)",
  "channels": { "push": true, "inApp": true, "email": true }
}

// grade.downgrade (등급 변경 완료)
{
  "type": "downgrade",
  "previousGrade": "gold",
  "newGrade": "silver",
  "effectiveDate": "2025-07-15",
  "title": "등급 변경 안내",
  "message": "등급이 골드에서 실버로 변경되었습니다. 새 캠페인 매칭 후 캠페인 종료 시 등급이 재산정됩니다.",
  "supplementaryMessage": "멤버십 상태별 부가 안내 (2.1.3.2. > 2: CTA 분기 로직 참조)",
  "cta": "멤버십 상태별 분기 (2.1.3.2. > 2: CTA 분기 로직 참조)",
  "channels": { "push": true, "inApp": true, "email": true }
}

// grade.recalculated (업그레이드)
{
  "type": "recalculated",
  "previousGrade": "silver",
  "newGrade": "gold",
  "upgraded": true,
  "newScore": 64,
  "effectiveDate": "2025-08-01",
  "title": "등급 상승 축하드립니다",
  "message": "등급이 실버에서 골드로 상승했습니다. 새로운 혜택을 확인해 보세요.",
  "cta": { "text": "혜택 확인하기", "target": "/partner/grade/benefits" },
  "channels": { "push": true, "inApp": true, "email": true }
}
```  


**2.1.3.4.** 접근성 요구사항  

1: 섹션 ARIA  
　A. role="region"  
　B. aria-labelledby="my-grade-title"  

2: 등급 마크 ARIA  
　A. role="img" (정보 표시용)  
　B. aria-label="현재 등급: {등급명}"  

3: 키보드 내비게이션  
　A. Tab: 등급 마크, 버튼 간 이동  
　B. Enter/Space: 클릭 동작  


**2.1.3.5.** 에러 처리  

1: 에러 코드  
　A. GRS_001: 등급 현황 조회 실패  

2: 사용자 메시지  
　A. "등급 현황을 불러오지 못했습니다"  
　B. 재시도 버튼 표시  


**2.1.3.6.** 스타일 구현  

1: 등급별 색상 정의  

```javascript
const gradeStyles = {
  bronze: {
    color: '#CD7F32',
    bgColor: 'rgba(205, 127, 50, 0.1)',
    borderColor: '#CD7F32'
  },
  silver: {
    color: '#C0C0C0',
    bgColor: 'rgba(192, 192, 192, 0.1)',
    borderColor: '#C0C0C0'
  },
  gold: {
    color: '#FFD700',
    bgColor: 'rgba(255, 215, 0, 0.1)',
    borderColor: '#FFD700'
  },
  platinum: {
    color: '#E5E4E2',
    bgColor: 'rgba(229, 228, 226, 0.1)',
    borderColor: '#E5E4E2'
  }
};
```

2: 적용 대상  
　A. 섹션 배경색: bgColor  
　B. 섹션 테두리: borderColor  
　C. 등급명 텍스트: color  
　D. 등급 마크 강조: color  


• 참조: 7-2-4-1 > 1.1.3. 개발자 인터랙션 명세
