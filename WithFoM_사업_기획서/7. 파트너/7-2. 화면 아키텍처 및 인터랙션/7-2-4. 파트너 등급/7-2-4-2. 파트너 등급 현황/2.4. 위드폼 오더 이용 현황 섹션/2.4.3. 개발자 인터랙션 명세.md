<!-- WF:DOC=DEV -->
**2.4.3.** 개발자 인터랙션 명세  


**2.4.3.1.** 위드폼 오더 이용 현황 조회 API  

1: 엔드포인트  
　A. GET /api/v1/partner/order/status  

2: 응답 구조 (이용 중)  

```json
{
  "isActive": true,
  "startDate": "2025-03-15T00:00:00Z",
  "usageDays": 320
}
```

3: 응답 구조 (미이용)  

```json
{
  "isActive": false,
  "startDate": null,
  "usageDays": 0
}
```


**2.4.3.2.** 오더 기능 ON/OFF 토글 API  

1: 엔드포인트  
　A. PUT /api/v1/partner/order/toggle  

2: 요청 구조  

```json
{
  "isActive": true
}
```

3: 응답 구조 (활성화)  

```json
{
  "isActive": true,
  "startDate": "2025-03-15T00:00:00Z",
  "usageDays": 320,
  "message": "위드폼 오더가 활성화되었습니다"
}
```

4: 응답 구조 (비활성화)  

```json
{
  "isActive": false,
  "startDate": "2025-03-15T00:00:00Z",
  "usageDays": 320,
  "message": "위드폼 오더가 비활성화되었습니다"
}
```

5: 처리 로직  
　A. ON 전환 시: startDate 자동 기록 (최초 활성화 시에만, 재활성화 시 기존 시작일 유지)  
　B. OFF 전환 시: isActive만 false로 변경, startDate/usageDays는 보존  
　C. 응답에 usageDays 포함하여 UI에서 즉시 갱신 가능  
　D. 7-2-9. 주문 관리 페이지와 상태 동기화 (WebSocket)  


**2.4.3.3.** 스위치 상태 연동  

1: WebSocket 이벤트  
　A. order.status_changed: 오더 상태 변경 시 발행  

2: 이벤트 페이로드  

```json
{
  "type": "order_status_changed",
  "isActive": true,
  "changedAt": "2026-01-25T14:32:15Z",
  "source": "grade_status_page"
}
```

3: 연결 정보  
　A. 엔드포인트: wss://api.withfom.com/partner/grade/status/realtime  
　B. 인증: JWT 토큰 기반 연결  
　C. 2.1.3.3 / 2.3.2.4와 동일 WebSocket 연결 공유  

4: 동기화 대상  
　A. 7-2-4-2 > 2.4. 위드폼 오더 이용 현황 섹션 스위치  
　B. 7-2-9. 주문 관리 페이지 스위치  
　C. source 필드로 변경 출처 구분하여 무한 루프 방지  


**2.4.3.4.** 컴포넌트 상태 관리  

1: 스위치 상태 (orderToggleState)  
　A. isActive: boolean  
　B. isLoading: boolean (API 호출 중)  

2: 확인 다이얼로그 상태 (confirmDialogState)  
　A. visible: boolean  
　B. type: "activate" | "deactivate"  

3: 다이얼로그 메시지 매핑  

```javascript
const getToggleDialogConfig = (type) => {
  if (type === 'activate') {
    return {
      message: '위드폼 오더 기능을 활성화합니다.',
      confirmText: '활성화',
      cancelText: '취소',
      style: 'confirm'
    };
  }
  if (type === 'deactivate') {
    return {
      message: '위드폼 오더를 비활성화하면 등급 산정 시 오더 이용 점수가 반영되지 않으며, 플래티넘 등급 산정 조건에서 제외됩니다.',
      confirmText: '비활성화',
      cancelText: '취소',
      style: 'warning'
    };
  }
};
```

4: 섹션 스타일 분기  
　A. isActive === true: 배경 연한 초록색, 테두리 초록색  
　B. isActive === false: 배경 연한 회색, 테두리 회색  


**2.4.3.5.** 접근성 요구사항  

1: 스위치 ARIA  
　A. role="switch"  
　B. aria-checked="{true/false}"  
　C. aria-label="위드폼 오더 기능 {활성화/비활성화}"  

2: 섹션 ARIA  
　A. role="region"  
　B. aria-labelledby="order-status-title"  

3: 키보드 내비게이션  
　A. Tab: 스위치로 포커스 이동  
　B. Enter/Space: 스위치 토글 (다이얼로그 표시)  
　C. Escape: 다이얼로그 닫기  


**2.4.3.6.** 에러 처리  

1: 에러 코드  
　A. GRS_004: 오더 현황 조회 실패  
　B. GRS_005: 오더 상태 변경 실패  

2: 사용자 메시지  
　A. 조회 실패: "오더 현황을 불러오지 못했습니다"  
　B. 변경 실패: "오더 상태 변경에 실패했습니다. 다시 시도해주세요"  
　C. 에러 시 스위치 상태를 변경 전으로 롤백  


**2.4.3.7.** 성능 최적화  

1: 캐싱  
　A. 세션 스토리지에 30분 캐싱  
　B. 페이지 진입 시 캐시 유효성 확인 후 API 호출  
　C. 토글 성공 시 캐시 즉시 갱신  


• 참조: 7-2-4-2 > 2.3.2. 개발자 인터랙션 명세, 7-2-9. 주문 관리
