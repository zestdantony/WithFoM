<!-- WF:DOC=DEV -->
**1.3.3.** ê°œë°œì ì¸í„°ë™ì…˜ ëª…ì„¸  


**1.3.3.1.** ì ìˆ˜ ê³„ì‚° API  

1: ì—”ë“œí¬ì¸íŠ¸  
ã€€A. POST /api/v1/partner/grade/calculate  

2: ìš”ì²­ ë°”ë””  

```json
{
  "reportRate": 95,
  "scanRate": 105,
  "useWithfomOrder": true
}
```

3: ì‘ë‹µ êµ¬ì¡° (í™”ë©´ í‘œì‹œìš©)  

```json
{
  "calculation": {
    "reportRateScore": {
      "displayInput": 95,
      "level": "ì¤‘",
      "displayLabel": "100%",
      "score": 60,
      "weighted": 27
    },
    "scanRateScore": {
      "displayInput": 105,
      "level": "ì¤‘",
      "displayLabel": "100~114%",
      "score": 60,
      "weighted": 27
    },
    "withfomOrderScore": {
      "input": true,
      "score": 100,
      "weighted": 10
    },
    "totalScore": 64,
    "predictedGrade": "gold",
    "gradeInfo": {
      "name": "ê³¨ë“œ",
      "icon": "ğŸ¥‡",
      "color": "#FFD700"
    },
    "nextGrade": {
      "name": "í”Œë˜í‹°ë„˜",
      "requiredScore": 73,
      "gap": 9,
      "requirements": [
        "ë³´ê³ ìœ¨ 100% í•„ìš”",
        "ìŠ¤ìº”ìœ¨ 115% ì´ˆê³¼ í•„ìš”",
        "ìœ„ë“œí¼ ì˜¤ë” ì´ìš©"
      ]
    }
  }
}
```

<!-- WF:INTERNAL - ë‚´ë¶€ ì‹œìŠ¤í…œ ì ìš© ê¸°ì¤€
ì‹¤ì œ ë“±ê¸‰ íŒì • ì‹œ ì‚¬ìš©í•˜ëŠ” ì‹¤ì§ˆ ê¸°ì¤€:
- ë³´ê³ ìœ¨: í™”ë©´ í‘œì‹œ 85%/100% â†’ ì‹¤ì§ˆ ì ìš© 70%/90%
- í”Œë˜í‹°ë„˜ ë‹¬ì„±: ìœ„ë“œí¼ ì˜¤ë” ë¯¸ì´ìš© ì‹œ ê³¨ë“œê¹Œì§€ë§Œ ê°€ëŠ¥
â€» ìœ„ ì‘ë‹µì—ëŠ” displayLabelë§Œ í¬í•¨, ì‹¤ì§ˆ ê¸°ì¤€ì€ ì„œë²„ ë‚´ë¶€ì—ì„œë§Œ ì²˜ë¦¬
-->


**1.3.3.2.** í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì ìˆ˜ ê³„ì‚°  

```javascript
/**
 * í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì ìˆ˜ ê³„ì‚° (í™”ë©´ í‘œì‹œìš©)
 * â€» ì‹¤ì œ ë“±ê¸‰ íŒì •ì€ ì„œë²„ì—ì„œ ì‹¤ì§ˆ ê¸°ì¤€ìœ¼ë¡œ ìˆ˜í–‰
 */
const calculateGradeScore = (displayReportRate, scanRate, useWithfomOrder) => {
  // ë³´ê³ ìœ¨ ì ìˆ˜ (45%) - í™”ë©´ í‘œì‹œìš© ê¸°ì¤€ ì‚¬ìš©
  let reportScore = 0;
  if (displayReportRate < 85) reportScore = 20;
  else if (displayReportRate < 100) reportScore = 40;
  else reportScore = 60;
  // 1ë…„ ìœ ì§€ ì‹œ 80ì  (í”Œë˜í‹°ë„˜ ì¡°ê±´)
  
  // ìŠ¤ìº”ìœ¨ ì ìˆ˜ (45%)
  let scanScore = 0;
  if (scanRate < 80) scanScore = 20;
  else if (scanRate < 100) scanScore = 40;
  else if (scanRate <= 114) scanScore = 60;
  else scanScore = 80; // 115% ì´ˆê³¼
  
  // ìœ„ë“œí¼ ì˜¤ë” ì ìˆ˜ (10%)
  const orderScore = useWithfomOrder ? 100 : 0;
  
  // ê°€ì¤‘ í•©ì‚°
  const totalScore = 
    (reportScore * 0.45) + 
    (scanScore * 0.45) + 
    (orderScore * 0.10);
  
  // ë“±ê¸‰ íŒì • (í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì˜ˆìƒ - ìµœì¢… íŒì •ì€ ì„œë²„)
  let grade = 'bronze';
  if (totalScore >= 73) grade = 'platinum';
  else if (totalScore >= 55) grade = 'gold';
  else if (totalScore >= 36) grade = 'silver';
  
  return { totalScore, grade };
};

/**
 * WF:INTERNAL - ì„œë²„ ì¸¡ ì‹¤ì§ˆ íŒì • ë¡œì§ (ì°¸ì¡°ìš©)
 * 
 * ì‹¤ì§ˆ ì ìš© ê¸°ì¤€:
 * - displayReportRate 85% â†’ actualReportRate 70% ì´ìƒ
 * - displayReportRate 100% â†’ actualReportRate 90% ì´ìƒ
 * - í”Œë˜í‹°ë„˜: !useWithfomOrder â†’ 'gold'ë¡œ ê°•ì œ ë“±ê¸‰ ë³€ê²½
 */
```


**1.3.3.3.** ì»´í¬ë„ŒíŠ¸ ìƒíƒœ ê´€ë¦¬  

1: íƒ­ ìƒíƒœ (activeTab)  
ã€€A. bronze / silver / gold / platinum  
ã€€B. ê¸°ë³¸ê°’: í˜„ì¬ íŒŒíŠ¸ë„ˆ ë“±ê¸‰  

2: ê³„ì‚°ê¸° ìƒíƒœ (calculatorState)  
ã€€A. isOpen: boolean  
ã€€B. reportRate: number (0-100)  
ã€€C. scanRate: number (0-200)  
ã€€D. useWithfomOrder: boolean  
ã€€E. result: object (ê³„ì‚° ê²°ê³¼)  

3: íŒì—… ìƒíƒœ (popupState)  
ã€€A. isOpen: boolean  
ã€€B. resultData: object  

4: í™”ë©´ ì „í™˜ ìƒíƒœ (navigationState)  
ã€€A. isNavigating: boolean  
ã€€B. targetPage: string  


**1.3.3.4.** íŒì—… ë° í™”ë©´ ì „í™˜ ëª…ì„¸  

1: íŒì—… ì• ë‹ˆë©”ì´ì…˜  
ã€€A. ë“±ì¥: fadeIn + scaleUp (200ms)  
ã€€B. ì´ˆê¸° ìŠ¤ì¼€ì¼: 0.95 â†’ 1.0  
ã€€C. ë°°ê²½ ë”¤ ì²˜ë¦¬: rgba(0,0,0,0.5)  
ã€€D. ì‚¬ë¼ì§: fadeOut (150ms)  

2: íŒì—… ë‹«ê¸° ë™ì‘  
ã€€A. ì™¸ë¶€ í´ë¦­: íŒì—… ì™¸ë¶€ ì˜ì—­ í´ë¦­ ì‹œ ë‹«í˜  
ã€€B. X ë²„íŠ¼: íŒì—… ìš°ì¸¡ ìƒë‹¨ X ë²„íŠ¼ í´ë¦­ ì‹œ ë‹«í˜  
ã€€C. ESC í‚¤: í‚¤ë³´ë“œ ESC ì…ë ¥ ì‹œ ë‹«í˜  

3: ë“±ê¸‰ í˜„í™© ë³´ê¸° í™”ë©´ ì „í™˜  
ã€€A. ì „í™˜ ë°©í–¥: ì¢Œì¸¡ì—ì„œ ìš°ì¸¡ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œ  
ã€€B. duration: 300ms  
ã€€C. easing: ease-in-out  
ã€€D. ëª©ì ì§€: /partner/grade/status  
ã€€E. ìë™ ìŠ¤í¬ë¡¤: ë‚˜ì˜ ë“±ê¸‰ ì„¹ì…˜ìœ¼ë¡œ ì´ë™  


**1.3.3.5.** ì ‘ê·¼ì„± ìš”êµ¬ì‚¬í•­  

1: íƒ­ ì˜ì—­ ARIA  
ã€€A. role="tablist"  
ã€€B. aria-label="ë“±ê¸‰ë³„ ê¸°ì¤€í‘œ"  
ã€€C. ê° íƒ­: role="tab", aria-selected="true/false"  

2: ê³„ì‚°ê¸° ì˜ì—­ ARIA  
ã€€A. ìŠ¬ë¼ì´ë”: aria-valuemin, aria-valuemax, aria-valuenow  
ã€€B. í† ê¸€: role="switch", aria-checked  

3: í‚¤ë³´ë“œ ë‚´ë¹„ê²Œì´ì…˜  
ã€€A. â† / â†’: íƒ­ ê°„ ì´ë™  
ã€€B. Enter / Space: íƒ­ ì„ íƒ  
ã€€C. Tab: ê³„ì‚°ê¸° í•„ë“œ ê°„ ì´ë™  


**1.3.3.6.** ì—ëŸ¬ ì²˜ë¦¬  

1: ì—ëŸ¬ ì½”ë“œ  
ã€€A. GRD_003: ì ìˆ˜ ê³„ì‚° ì‹¤íŒ¨  

2: ì‚¬ìš©ì ë©”ì‹œì§€  
ã€€A. "ì ìˆ˜ ê³„ì‚°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"  
ã€€B. ì¬ì‹œë„ ë²„íŠ¼ í‘œì‹œ  


**1.3.3.7.** ë“±ê¸‰ ìœ ì§€/ë“±ê¸‰ ë³€ê²½ ë¡œì§  

1: ë¯¸ë§¤ì¹­ ê¸°ê°„ ì¡°íšŒ  
ã€€A. ì—”ë“œí¬ì¸íŠ¸: GET /api/v1/partner/grade/unmatched-status  
ã€€B. ì‘ë‹µ êµ¬ì¡°:  

```json
{
  "partnerId": "string",
  "currentGrade": "gold",
  "lastCampaignEndDate": "2024-01-15",
  "unmatchedDays": 45,
  "unmatchedMonths": 1.5,
  "downgradeDate": "2024-07-15",
  "daysUntilDowngrade": 135,
  "alerts": {
    "firstWarning": { "sent": false, "triggerDate": "2024-04-15" },
    "finalWarning": { "sent": false, "triggerDate": "2024-06-08" }
  }
}
```

2: ë“±ê¸‰ ë³€ê²½ ì²˜ë¦¬  

```javascript
const processDowngrade = (partnerGrade) => {
  const downgradeMap = {
    'platinum': 'gold',
    'gold': 'silver',
    'silver': 'bronze',
    'bronze': 'bronze' // ìµœí•˜ ë“±ê¸‰ ìœ ì§€
  };
  return downgradeMap[partnerGrade];
};
```

3: ì¬ì‚°ì • í›„ ì¦‰ì‹œ ì—…ê·¸ë ˆì´ë“œ  
ã€€A. ë“±ê¸‰ ë³€ê²½ í›„ ìƒˆ ìº í˜ì¸ ì¢…ë£Œ ì‹œ ìë™ ì¬ì‚°ì •  
ã€€B. ì¡°ê±´ ì¶©ì¡± ì‹œ ìµì›” 1ì¼ ì¦‰ì‹œ ì—…ê·¸ë ˆì´ë“œ ì ìš©  


**1.3.3.8.** ë¯¸ë§¤ì¹­ ì•Œë¦¼ ì‹œìŠ¤í…œ  

1: ì•Œë¦¼ ìŠ¤ì¼€ì¤„ëŸ¬  

```javascript
const unmatchedAlertScheduler = {
  // 1ì°¨ ì•Œë¦¼: 3ê°œì›” ê²½ê³¼ (90ì¼)
  firstWarning: {
    triggerDays: 90,
    title: "ë“±ê¸‰ ìœ ì§€ ì•ˆë‚´",
    body: "ë§ˆì§€ë§‰ ìº í˜ì¸ ì¢…ë£Œ í›„ 3ê°œì›”ì´ ì§€ë‚¬ìŠµë‹ˆë‹¤. {currentGrade} ë“±ê¸‰ ìœ ì§€ë¥¼ ìœ„í•´ ìƒˆë¡œìš´ ìº í˜ì¸ì— ì°¸ì—¬ê°€ ì‹œê¸‰í•©ë‹ˆë‹¤. (ë¯¸ì°¸ì—¬ ì‹œ {targetGrade}ë¡œ ì¡°ì •)",
    cta: getMembershipBasedCTA(partnerMembership, partnerGrade)
    // ë©¤ë²„ì‹­ ìƒíƒœë³„ ë¶„ê¸°: ë² ì´ì§ â†’ ë©¤ë²„ì‹­ êµ¬ë…, í”ŒëŸ¬ìŠ¤ â†’ í”„ë¦¬ë¯¸ì—„ ì—…ê·¸ë ˆì´ë“œ, í”„ë¦¬ë¯¸ì—„+í”Œë˜í‹°ë„˜ â†’ ì •ë³´ì„± ì•ˆë‚´, í”„ë¦¬ë¯¸ì—„+ê³¨ë“œì´í•˜ â†’ ë“±ê¸‰ í˜„í™©
  },
  // ìµœì¢… ì•Œë¦¼: 5ê°œì›” 3ì£¼ì°¨ ë§ˆì§€ë§‰ ë‚  (ì•½ 173ì¼)
  finalWarning: {
    triggerDays: 173,
    title: "[ìµœì¢… ì•Œë¦¼] ë“±ê¸‰ ì¡°ì • ì˜ˆì •",
    body: "ë“±ê¸‰ ì¡°ì •ê¹Œì§€ 7ì¼ ë‚¨ì•˜ìŠµë‹ˆë‹¤. {currentGrade} ë“±ê¸‰ê³¼ í˜œíƒì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ìƒˆ ìº í˜ì¸ ì°¸ì—¬ê°€ ì‹œê¸‰í•©ë‹ˆë‹¤. (ë¯¸ì°¸ì—¬ ì‹œ {targetGrade}ë¡œ ì¡°ì •)",
    cta: getMembershipBasedCTA(partnerMembership, partnerGrade)
    // ë©¤ë²„ì‹­ ìƒíƒœë³„ ë¶„ê¸°: 1ì°¨ ì•Œë¦¼ê³¼ ë™ì¼ ë¡œì§
  },
  // ë“±ê¸‰ ë³€ê²½ ì™„ë£Œ: 6ê°œì›” (180ì¼)
  downgrade: {
    triggerDays: 180,
    title: "ë“±ê¸‰ ë³€ê²½ ì•ˆë‚´",
    body: "ë“±ê¸‰ì´ {previousGrade}ì—ì„œ {newGrade}ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.",
    cta: getDowngradeCTA(partnerMembership)
    // ë² ì´ì§/í”ŒëŸ¬ìŠ¤ â†’ "ë§¤ì¹­ í™•ë¥  UP" + ë©¤ë²„ì‹­ ì—…ê·¸ë ˆì´ë“œ ìœ ë„, í”„ë¦¬ë¯¸ì—„ â†’ "ë“±ê¸‰ í˜„í™© ë³´ê¸°"
  },
  // ì—…ê·¸ë ˆì´ë“œ ì™„ë£Œ
  upgrade: {
    title: "ë“±ê¸‰ ìƒìŠ¹ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤",
    body: "ë“±ê¸‰ì´ {previousGrade}ì—ì„œ {newGrade}ìœ¼ë¡œ ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ í˜œíƒì„ í™•ì¸í•´ ë³´ì„¸ìš”.",
    cta: { text: "í˜œíƒ í™•ì¸í•˜ê¸°", target: "/partner/grade/benefits" }
  }
};
```

2: ì•Œë¦¼ ì±„ë„ ì²˜ë¦¬  

```javascript
const sendGradeAlert = async (partnerId, alertType, gradeInfo) => {
  const alertConfig = unmatchedAlertScheduler[alertType];
  const message = formatMessage(alertConfig, gradeInfo);
  
  // ì±„ë„ë³„ ë°œì†¡
  const channels = {
    push: true,      // í•„ìˆ˜
    inApp: true,     // í•„ìˆ˜ (ì•Œë¦¼ ì„¼í„° ì €ì¥)
    email: await isEmailAlertEnabled(partnerId)  // ì„ íƒ (ì„¤ì •ì— ë”°ë¦„)
  };
  
  if (channels.push) await sendPushNotification(partnerId, message);
  if (channels.inApp) await saveToNotificationCenter(partnerId, message);
  if (channels.email) await sendEmailNotification(partnerId, message);
};
```

3: ì•Œë¦¼ API  
ã€€A. ì—”ë“œí¬ì¸íŠ¸: POST /api/v1/partner/grade/send-alert  
ã€€B. ìš”ì²­: { partnerId, alertType, currentGrade, targetGrade, channels }  


**1.3.3.9.** ì¤‘ë„ í¬ê¸° ì²˜ë¦¬  

1: API  
ã€€A. ì—”ë“œí¬ì¸íŠ¸: POST /api/v1/partner/campaign/withdraw  

2: ì²˜ë¦¬ ë¡œì§  

```javascript
const handleCampaignWithdraw = (partnerId, campaignId, withdrawDate) => {
  // í¬ê¸° ì „ê¹Œì§€ ì°¸ì—¬ ê¸°ê°„ì€ ì‚°ì •ì— í¬í•¨
  updateParticipationDays(partnerId, campaignId, withdrawDate);
  
  // í¬ê¸° ì‹œì ë¶€í„° ë¯¸ë§¤ì¹­ ì¹´ìš´íŠ¸ ì‹œì‘
  setUnmatchedStartDate(partnerId, withdrawDate);
  
  return {
    participationDays: getParticipationDays(partnerId, campaignId),
    unmatchedStartDate: withdrawDate
  };
};
```


**1.3.3.10.** ì„±ëŠ¥ ìµœì í™”  

1: ê³„ì‚° ìµœì í™”  
ã€€A. debounce ì ìš© (300ms)  
ã€€B. í´ë¼ì´ì–¸íŠ¸ ì¸¡ ê³„ì‚° ìš°ì„ , ì„œë²„ ê²€ì¦ í›„ì²˜ë¦¬  

2: ë Œë”ë§ ìµœì í™”  
ã€€A. ì„ íƒëœ íƒ­ë§Œ ë Œë”ë§ (lazy rendering)  
ã€€B. íƒ­ ì „í™˜ ì‹œ ì´ì „ íƒ­ ìƒíƒœ ìœ ì§€  


â€¢ ì°¸ì¡°: 7-2-4-1 > 1.1.3. ê°œë°œì ì¸í„°ë™ì…˜ ëª…ì„¸
