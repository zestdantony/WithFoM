**1.9.** 개발자 인터랙션 명세  


**1.9.1.** 데이터 연동 방식  

**1.9.1.1.** REST API 기반  
1: 연동 방식  
　A. 페이지 로드 시 REST API 호출로 데이터 조회  
　B. CRUD 작업 시 REST API 호출  
2: 실시간 갱신  
　A. 판매 연동 차감: WebSocket으로 실시간 반영  
　B. 자동 입고: WebSocket으로 알림 및 갱신  

**1.9.1.2.** WebSocket 연결  
1: 연결 엔드포인트  
　A. wss://api.withfom.com/partner/inventory/realtime  
　B. 인증: JWT 토큰 기반 연결  
2: 이벤트 수신  
　A. inventory.stock_updated: 재고 변동  
　B. inventory.auto_receipt: 자동 입고 완료  
　C. inventory.low_stock_alert: 재고 부족 알림  
　D. inventory.auto_order_created: 자동 발주 생성  


**1.9.2.** API 명세  

**1.9.2.1.** 품목 목록 조회  
1: 엔드포인트  
　A. GET /api/v1/partner/inventory/items  
2: 요청 파라미터  
　A. category (optional): 카테고리 필터  
　B. stockStatus (optional): 재고 상태 필터 (normal/warning/critical/empty)  
　C. autoOrderEnabled (optional): 자동 발주 활성화 여부  
　D. page, limit: 페이지네이션  
3: 응답 구조  

```json
{
  "items": [
    {
      "itemId": "INV-001",
      "itemCode": "CUP-12-001",
      "itemName": "종이컵 12oz",
      "category": "컵/용기류",
      "currentStock": 450,
      "unit": "ea",
      "safetyStock": 100,
      "stockStatus": "normal",
      "autoOrderEnabled": true,
      "autoOrderThreshold": 100,
      "autoOrderQuantity": 500,
      "purchasePrice": 50,
      "linkedToAdmin": true,
      "lastReceiptDate": "2026-01-25",
      "pendingConfirmation": false
    }
  ],
  "summary": {
    "totalItems": 45,
    "normalCount": 38,
    "warningCount": 5,
    "criticalCount": 2,
    "emptyCount": 0
  },
  "pagination": {
    "page": 1,
    "limit": 20,
    "totalPages": 3,
    "totalCount": 45
  }
}
```


**1.9.2.2.** 품목 상세 조회  
1: 엔드포인트  
　A. GET /api/v1/partner/inventory/items/{itemId}  
2: 응답 구조  

```json
{
  "item": {
    "itemId": "INV-001",
    "itemCode": "CUP-12-001",
    "itemName": "종이컵 12oz",
    "category": "컵/용기류",
    "currentStock": 450,
    "unit": "ea",
    "safetyStock": 100,
    "stockStatus": "normal",
    "autoOrderEnabled": true,
    "autoOrderThreshold": 100,
    "autoOrderQuantity": 500,
    "purchasePrice": 50,
    "supplier": "위드폼 공식몰",
    "linkedToAdmin": true,
    "imageUrl": "https://...",
    "memo": "12oz 표준 종이컵"
  },
  "consumption": {
    "dailyAverage": 42,
    "weeklyAverage": 294,
    "estimatedDepletionDays": 10,
    "recommendedOrderDate": "2026-01-28"
  },
  "stockHistory": [
    {
      "historyId": "HST-001",
      "type": "outbound_sales",
      "quantity": -5,
      "stockAfter": 450,
      "orderId": "ORD-2026-001234",
      "memo": "아메리카노 x5",
      "createdAt": "2026-01-28T14:35:00Z",
      "createdBy": "system"
    }
  ],
  "orderHistory": [
    {
      "orderId": "PO-001",
      "orderDate": "2026-01-20",
      "quantity": 500,
      "amount": 25000,
      "status": "delivered",
      "deliveredDate": "2026-01-25",
      "receiptStatus": "confirmed"
    }
  ]
}
```


**1.9.2.3.** 품목 등록  
1: 엔드포인트  
　A. POST /api/v1/partner/inventory/items  
2: 요청 바디  

```json
{
  "itemName": "종이컵 16oz",
  "category": "컵/용기류",
  "unit": "ea",
  "initialStock": 500,
  "safetyStock": 100,
  "purchasePrice": 60,
  "autoOrderEnabled": false,
  "memo": ""
}
```

3: 응답 구조  

```json
{
  "success": true,
  "itemId": "INV-002",
  "itemCode": "CUP-16-001",
  "message": "품목이 등록되었습니다."
}
```


**1.9.2.4.** 재고 조정  
1: 엔드포인트  
　A. POST /api/v1/partner/inventory/items/{itemId}/adjust  
2: 요청 바디  

```json
{
  "adjustmentType": "inbound",
  "quantity": 100,
  "reason": "external_purchase",
  "memo": "외부 구매 입고"
}
```

3: adjustmentType 값  
　A. inbound: 입고  
　B. outbound: 출고  
　C. adjustment: 실사 조정  
　D. disposal: 폐기/손실  
4: 응답 구조  

```json
{
  "success": true,
  "itemId": "INV-001",
  "previousStock": 450,
  "newStock": 550,
  "adjustmentId": "ADJ-001",
  "message": "재고가 조정되었습니다."
}
```


**1.9.2.5.** 입고 확인  
1: 엔드포인트  
　A. POST /api/v1/partner/inventory/receipts/{receiptId}/confirm  
2: 요청 바디  

```json
{
  "action": "confirm",
  "actualQuantity": 500,
  "note": ""
}
```

3: action 값  
　A. confirm: 확인 완료  
　B. adjust: 수량 조정 (actualQuantity 필수)  
　C. dispute: 이의 신청  


**1.9.3.** 컴포넌트 상태 관리  

**1.9.3.1.** 재고 상태 정의  
1: 재고 상태 (stockStatus)  
　A. normal: 정상 (녹색)  
　B. warning: 주의 (노란색)  
　C. critical: 위험 (빨간색)  
　D. empty: 품절 (검정)  
2: UI 상태 (uiState)  
　A. idle: 기본 상태  
　B. loading: 로딩 중  
　C. editing: 편집 중  
　D. confirming: 확인 처리 중  

**1.9.3.2.** 상태 계산 로직  

```javascript
const getStockStatus = (currentStock, safetyStock) => {
  if (currentStock === 0) return 'empty';
  if (currentStock <= safetyStock) return 'critical';
  if (currentStock <= safetyStock * 1.5) return 'warning';
  return 'normal';
};
```


**1.9.4.** 실시간 재고 갱신  

**1.9.4.1.** WebSocket 이벤트 핸들링  

```javascript
const handleStockUpdate = (event) => {
  if (event.type === 'inventory.stock_updated') {
    const { itemId, currentStock, stockStatus, changeType, changeQuantity } = event.data;
    
    // 재고 상태 업데이트
    updateItemStock(itemId, currentStock, stockStatus);
    
    // 변동 알림 (선택적)
    if (changeType === 'outbound_sales') {
      // 판매 연동 차감 - 조용히 처리
    } else if (changeType === 'auto_receipt') {
      showToast('자동 입고가 완료되었습니다. 확인해 주세요.', 'info');
    }
  }
};

const handleAutoReceipt = (event) => {
  if (event.type === 'inventory.auto_receipt') {
    const { itemId, quantity, orderId } = event.data;
    
    // 확인 요망 뱃지 표시
    setPendingConfirmation(itemId, true);
    
    // 알림 표시
    showNotification({
      title: '입고 확인 필요',
      body: `${event.data.itemName} ${quantity}${event.data.unit} 입고되었습니다.`,
      action: { type: 'navigate', target: `/inventory/items/${itemId}` }
    });
  }
};
```


**1.9.5.** 에러 처리  

**1.9.5.1.** 에러 코드 정의  
1: 에러 코드  
　A. INV_001: 품목 조회 실패  
　B. INV_002: 품목 등록 실패 (중복 등)  
　C. INV_003: 재고 조정 실패  
　D. INV_004: 재고 부족 (음수 불가)  
　E. INV_005: 자동 발주 불가 (미연동 품목)  
　F. INV_006: 입고 확인 실패  

**1.9.5.2.** 에러 처리 방식  
1: API 호출 실패  
　A. 자동 재시도: 3회, 간격 2초  
　B. 실패 시 에러 토스트 표시  
　C. [다시 시도] 버튼 제공  


**1.9.6.** 접근성 요구사항  

**1.9.6.1.** ARIA 레이블  
1: 리스트 영역  
　A. role="table"  
　B. aria-label="재고 품목 목록"  
2: 상태 뱃지  
　A. aria-label="재고 상태: {상태}"  
3: 확인 요망 뱃지  
　A. aria-label="입고 확인 필요"  
　B. role="button"  

**1.9.6.2.** 키보드 내비게이션  
1: Tab 순서  
　A. 검색창 → 필터 → 품목 추가 버튼 → 테이블 행 → 액션 버튼  
2: 단축키  
　A. Enter: 선택 항목 상세 보기  
　B. Escape: 모달 닫기  


**1.9.7.** 성능 최적화  

**1.9.7.1.** 렌더링 최적화  
1: 테이블 가상화  
　A. 품목 수가 많을 경우 가상 스크롤 적용  
　B. 화면에 보이는 행만 렌더링  
2: 검색 최적화  
　A. debounce 적용 (300ms)  
　B. 서버 사이드 검색  

**1.9.7.2.** 데이터 캐싱  
1: 캐싱 전략  
　A. 품목 목록: 5분 캐시  
　B. 재고 변동 시 해당 품목 캐시 무효화  
　C. WebSocket 이벤트로 실시간 갱신  


• 참조: 7-2-11-2. 발주 > 개발자 명세
