<!-- WF:DOC=DEV -->
**1.6.** 개발자 인터랙션 명세


**1.6.1.** 앱 스토어 연동

1: 딥링크 설정
　A. iOS App Store 링크: https://apps.apple.com/app/withfom-partner/id{APP_ID}
　B. Android Play Store 링크: https://play.google.com/store/apps/details?id=com.withfom.partner
　C. 유니버설 링크: https://partner.withfom.com/download

2: 기기 감지 로직

```javascript
const detectDevice = () => {
  const userAgent = navigator.userAgent || navigator.vendor;
  if (/iPad|iPhone|iPod/.test(userAgent)) return 'ios';
  if (/android/i.test(userAgent)) return 'android';
  return 'web';
};
```

3: 앱 스토어 리다이렉트

```javascript
const redirectToStore = () => {
  const device = detectDevice();
  const storeUrls = {
    ios: 'https://apps.apple.com/app/withfom-partner/id{APP_ID}',
    android: 'https://play.google.com/store/apps/details?id=com.withfom.partner',
    web: '/download'
  };
  window.location.href = storeUrls[device];
};
```


**1.6.2.** 앱 초기화 처리

1: 앱 최초 실행 감지
　A. 로컬 스토리지 확인: isFirstLaunch 플래그
　B. 최초 실행 시: isFirstLaunch = true
　C. 재실행 시: isFirstLaunch = false

2: 초기화 플로우

| 순서 | 동작 | 조건 |
|---|---|---|
| 1 | 스플래시 화면 표시 | 항상 |
| 2 | 앱 버전 확인 | 항상 |
| 3 | 강제 업데이트 체크 | 앱 버전 < 최소 버전 |
| 4 | 온보딩 표시 | isFirstLaunch === true |
| 5 | 로그인 상태 확인 | isFirstLaunch === false |
| 6 | 메인 화면 또는 로그인 화면 이동 | 로그인 상태에 따라 |

3: API 호출 - 앱 버전 확인
　A. 엔드포인트: GET /api/v1/app/version
　B. 응답 데이터

| 필드 | 타입 | 설명 |
|---|---|---|
| current_version | string | 최신 앱 버전 |
| min_version | string | 최소 지원 버전 |
| force_update | boolean | 강제 업데이트 필요 여부 |
| update_message | string | 업데이트 안내 메시지 |


**1.6.3.** 권한 요청 처리

1: 권한 요청 순서
　A. 알림 권한 (푸시)
　B. 위치 정보 권한
　C. 카메라 권한 (QR 스캔 시)

2: 권한 상태 확인 - iOS

```swift
// 알림 권한
UNUserNotificationCenter.current().getNotificationSettings { settings in
    switch settings.authorizationStatus {
    case .authorized: // 허용됨
    case .denied: // 거부됨
    case .notDetermined: // 미결정
    }
}

// 위치 권한
CLLocationManager.authorizationStatus()
```

3: 권한 상태 확인 - Android

```kotlin
// 알림 권한 (Android 13+)
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
    ContextCompat.checkSelfPermission(context, Manifest.permission.POST_NOTIFICATIONS)
}

// 위치 권한
ContextCompat.checkSelfPermission(context, Manifest.permission.ACCESS_FINE_LOCATION)
```

4: 권한 거부 시 처리

| 권한 | 처리 방법 |
|---|---|
| 알림 | 안내 메시지 표시 후 계속 진행 |
| 위치 정보 | 서비스 이용 불가 안내, 설정 앱 이동 버튼 제공 |
| 카메라 | 해당 기능 사용 시 재요청 |

5: 설정 앱 이동

```javascript
// React Native
Linking.openSettings();

// iOS Native
UIApplication.shared.open(URL(string: UIApplication.openSettingsURLString)!)

// Android Native
Intent(Settings.ACTION_APPLICATION_DETAILS_SETTINGS).apply {
    data = Uri.fromParts("package", packageName, null)
    startActivity(this)
}
```


**1.6.4.** 온보딩 처리

1: 온보딩 페이지 데이터

```javascript
const onboardingPages = [
  {
    id: 1,
    title: '위드폼 파트너에 오신 것을 환영합니다',
    description: '캠페인 매칭부터 정산까지, 위드폼이 함께합니다',
    image: '/images/onboarding/welcome.png'
  },
  {
    id: 2,
    title: '캠페인 매칭으로 수익 창출',
    description: '컵홀더 배포만으로 추가 수익을 얻으세요',
    image: '/images/onboarding/campaign.png'
  },
  {
    id: 3,
    title: '리워드와 오더 기능',
    description: 'QR 스캔 리워드와 앱 주문 기능을 활용하세요',
    image: '/images/onboarding/features.png'
  }
];
```

2: 온보딩 상태 관리
　A. 상태 변수: currentPage (1~3)
　B. [다음] 버튼: currentPage++
　C. [건너뛰기] 버튼: 온보딩 완료 처리
　D. [시작하기] 버튼 (마지막 페이지): 온보딩 완료 처리

3: 온보딩 완료 처리

```javascript
const completeOnboarding = async () => {
  await AsyncStorage.setItem('isFirstLaunch', 'false');
  await AsyncStorage.setItem('onboardingCompleted', 'true');
  navigation.navigate('TermsAgreement'); // 7-1-1-2
};
```


**1.6.5.** 화면 전환 처리

1: 네비게이션 스택 정의

| 화면 | 라우트명 | 설명 |
|---|---|---|
| 스플래시 | Splash | 앱 로딩 화면 |
| 온보딩 | Onboarding | 최초 실행 안내 |
| 이용 약관 동의 | TermsAgreement | 7-1-1-2 |
| 본인 인증 | IdentityVerification | 7-1-1-3 |
| 아이디/패스워드 설정 | AccountSetup | 7-1-1-4 |
| 매장 기본 정보 입력 | StoreBasicInfo | 7-1-1-5 |
| 사업자 인증 | BusinessVerification | 7-1-1-6 |
| 매장 상세 정보 설정 | StoreDetailInfo | 7-1-1-7 |
| 파트너 계약서 작성 | PartnerContract | 7-1-1-8 |
| 가입 완료 | SignupComplete | 7-1-1-9 |

2: 화면 전환 애니메이션

```javascript
const screenOptions = {
  headerShown: false,
  gestureEnabled: true,
  cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS,
  transitionSpec: {
    open: { animation: 'timing', config: { duration: 300 } },
    close: { animation: 'timing', config: { duration: 300 } }
  }
};
```


**1.6.6.** 에러 처리

1: 네트워크 오류
　A. 오프라인 감지: NetInfo 라이브러리 사용
　B. 에러 메시지: "네트워크 연결을 확인해주세요"
　C. 재시도 버튼 제공

2: 앱 버전 확인 실패
　A. 에러 메시지: "서버 연결에 실패했습니다"
　B. 재시도 버튼 제공
　C. 최대 재시도 횟수: 3회
　D. 실패 시: 오프라인 모드로 진행 (제한된 기능)

3: 에러 로깅

```javascript
const logError = async (error, context) => {
  await analytics.logEvent('app_error', {
    error_message: error.message,
    error_code: error.code,
    context: context,
    timestamp: new Date().toISOString()
  });
};
```


**1.6.7.** 접근성 요구사항

1: 스크린 리더 지원
　A. 온보딩 이미지에 대체 텍스트 적용
　B. 버튼에 적절한 접근성 라벨 적용
　C. 페이지 전환 시 알림 제공

2: 접근성 라벨 예시

```javascript
<Button
  accessibilityLabel="다음 페이지로 이동"
  accessibilityHint="온보딩 두 번째 페이지로 이동합니다"
  onPress={handleNext}
>
  다음
</Button>
```

3: 최소 터치 영역
　A. 버튼 최소 크기: 44x44pt (iOS), 48x48dp (Android)
　B. 터치 영역 간 간격: 최소 8pt


• 참조: 7-1-1-2. 이용 약관 및 개인정보 처리방침 동의
