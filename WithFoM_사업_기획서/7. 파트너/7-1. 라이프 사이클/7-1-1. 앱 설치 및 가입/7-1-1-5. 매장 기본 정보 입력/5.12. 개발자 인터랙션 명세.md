**5.12.** 개발자 인터랙션 명세


**5.12.1.** 폼 데이터 구조

1: 입력 상태 관리

```javascript
const [storeInfo, setStoreInfo] = useState({
  businessNumber: '',          // 사업자등록번호
  businessName: '',            // 사업자명 (자동)
  storeName: '',               // 매장명
  ownerName: '',               // 대표자명 (자동)
  email: '',                   // 이메일
  phone: '',                   // 연락처 (자동, 수정 가능)
  address: '',                 // 매장 주소
  addressDetail: '',           // 상세 주소
  pinLocation: { lat: 0, lng: 0 }, // 핀 위치
  businessHours: {
    days: [],                  // 영업 요일
    openTime: '',              // 시작 시간
    closeTime: '',             // 종료 시간
    breakTime: null            // 브레이크 타임
  },
  bankAccount: {
    bankCode: '',              // 은행 코드
    accountNumber: '',         // 계좌번호
    accountHolder: ''          // 예금주
  }
});
```


**5.12.2.** 사업자등록번호 처리

1: 번호 포맷팅

```javascript
const formatBusinessNumber = (value) => {
  const numbers = value.replace(/\D/g, '');
  if (numbers.length <= 3) return numbers;
  if (numbers.length <= 5) return `${numbers.slice(0, 3)}-${numbers.slice(3)}`;
  return `${numbers.slice(0, 3)}-${numbers.slice(3, 5)}-${numbers.slice(5, 10)}`;
};
```

2: 유효성 검사

```javascript
const validateBusinessNumber = (number) => {
  const cleaned = number.replace(/\D/g, '');
  if (cleaned.length !== 10) {
    return { valid: false, message: '사업자등록번호 10자리를 입력해주세요' };
  }
  // 사업자등록번호 체크섬 검증
  const checksum = calculateChecksum(cleaned);
  if (!checksum) {
    return { valid: false, message: '올바른 사업자등록번호를 입력해주세요' };
  }
  return { valid: true, message: '' };
};
```


**5.12.3.** 주소 검색 연동

1: 카카오 주소 API 연동

```javascript
import { useDaumPostcode } from 'react-daum-postcode';

const AddressSearch = ({ onComplete }) => {
  const open = useDaumPostcode({
    onComplete: (data) => {
      onComplete({
        zonecode: data.zonecode,
        address: data.roadAddress || data.jibunAddress,
        addressType: data.addressType,
        buildingName: data.buildingName
      });
    }
  });
  
  return <Button onPress={open}>주소 검색</Button>;
};
```

2: 지도 핀 설정

```javascript
import MapView, { Marker } from 'react-native-maps';

const PinSettingMap = ({ initialLocation, onConfirm }) => {
  const [pinLocation, setPinLocation] = useState(initialLocation);
  
  return (
    <MapView
      initialRegion={{
        latitude: initialLocation.lat,
        longitude: initialLocation.lng,
        latitudeDelta: 0.01,
        longitudeDelta: 0.01
      }}
    >
      <Marker
        coordinate={{ latitude: pinLocation.lat, longitude: pinLocation.lng }}
        draggable
        onDragEnd={(e) => setPinLocation({
          lat: e.nativeEvent.coordinate.latitude,
          lng: e.nativeEvent.coordinate.longitude
        })}
      />
    </MapView>
  );
};
```


**5.12.4.** 영업 시간 설정

1: 요일 선택 컴포넌트

```javascript
const DAYS = ['월', '화', '수', '목', '금', '토', '일'];

const DaySelector = ({ selectedDays, onChange }) => {
  const toggleDay = (day) => {
    const newDays = selectedDays.includes(day)
      ? selectedDays.filter(d => d !== day)
      : [...selectedDays, day];
    onChange(newDays);
  };
  
  const selectAll = () => onChange(DAYS);
  const selectWeekdays = () => onChange(['월', '화', '수', '목', '금']);
  
  return (
    <View>
      {DAYS.map(day => (
        <DayButton
          key={day}
          selected={selectedDays.includes(day)}
          onPress={() => toggleDay(day)}
        />
      ))}
      <Button onPress={selectAll}>매일</Button>
      <Button onPress={selectWeekdays}>평일만</Button>
    </View>
  );
};
```

2: 시간 선택 컴포넌트

```javascript
import DateTimePicker from '@react-native-community/datetimepicker';

const TimePicker = ({ label, value, onChange }) => {
  const [show, setShow] = useState(false);
  
  return (
    <View>
      <TouchableOpacity onPress={() => setShow(true)}>
        <Text>{label}: {formatTime(value)}</Text>
      </TouchableOpacity>
      {show && (
        <DateTimePicker
          mode="time"
          value={value}
          onChange={(event, selectedTime) => {
            setShow(false);
            onChange(selectedTime);
          }}
        />
      )}
    </View>
  );
};
```


**5.12.5.** 정산 계좌 처리

1: 은행 목록

```javascript
const BANKS = [
  { code: '004', name: 'KB국민은행' },
  { code: '088', name: '신한은행' },
  { code: '020', name: '우리은행' },
  { code: '081', name: '하나은행' },
  { code: '003', name: '기업은행' },
  { code: '011', name: '농협은행' },
  { code: '023', name: 'SC제일은행' },
  { code: '039', name: '경남은행' },
  // ... 기타 은행
];
```

2: API 호출 - 예금주 확인
　A. 엔드포인트: POST /api/v1/bank/verify-account
　B. 요청 바디

```json
{
  "bank_code": "004",
  "account_number": "1234567890123"
}
```

　C. 응답 데이터

| 필드 | 타입 | 설명 |
|---|---|---|
| valid | boolean | 계좌 유효 여부 |
| account_holder | string | 예금주명 |


**5.12.6.** 폼 제출 처리

1: API 호출 - 매장 기본 정보 저장
　A. 엔드포인트: POST /api/v1/partner/store/basic-info
　B. 요청 바디

```json
{
  "user_id": "user_123",
  "business_number": "123-45-67890",
  "store_name": "카페 위드폼",
  "owner_name": "홍길동",
  "email": "partner@example.com",
  "phone": "010-1234-5678",
  "address": {
    "road_address": "서울시 강남구 테헤란로 123",
    "detail_address": "1층",
    "zip_code": "06234"
  },
  "pin_location": {
    "latitude": 37.5665,
    "longitude": 126.9780
  },
  "business_hours": {
    "days": ["월", "화", "수", "목", "금"],
    "open_time": "09:00",
    "close_time": "21:00",
    "break_time": null
  },
  "bank_account": {
    "bank_code": "004",
    "account_number": "1234567890123",
    "account_holder": "홍길동"
  }
}
```

　C. 응답 데이터

| 필드 | 타입 | 설명 |
|---|---|---|
| success | boolean | 저장 성공 여부 |
| store_id | string | 생성된 매장 ID |


**5.12.7.** 화면 전환 처리

1: 다음 단계로 이동

```javascript
const handleSubmit = async () => {
  if (!validateForm()) {
    showValidationErrors();
    return;
  }
  
  try {
    const response = await saveStoreBasicInfo(storeInfo);
    if (response.success) {
      navigation.navigate('BusinessVerification', {
        businessNumber: storeInfo.businessNumber,
        storeId: response.store_id
      });
    }
  } catch (error) {
    handleError(error);
  }
};
```

2: 유효성 검사

```javascript
const validateForm = () => {
  const required = [
    'businessNumber',
    'storeName',
    'email',
    'address',
    'bankAccount.bankCode',
    'bankAccount.accountNumber'
  ];
  
  return required.every(field => {
    const value = getNestedValue(storeInfo, field);
    return value && value.trim() !== '';
  });
};
```


**5.12.8.** 에러 처리

1: 에러 코드 매핑

| 에러 코드 | 설명 | 사용자 메시지 |
|---|---|---|
| STORE_001 | 사업자등록번호 형식 오류 | 올바른 사업자등록번호를 입력해주세요 |
| STORE_002 | 주소 검색 실패 | 주소 검색에 실패했습니다 |
| STORE_003 | 계좌 확인 실패 | 계좌 정보를 확인해주세요 |
| STORE_004 | 저장 실패 | 정보 저장에 실패했습니다 |

2: 필드별 에러 표시

```javascript
const [fieldErrors, setFieldErrors] = useState({});

const validateField = (fieldName, value) => {
  let error = '';
  switch (fieldName) {
    case 'email':
      if (!isValidEmail(value)) error = '올바른 이메일을 입력해주세요';
      break;
    case 'phone':
      if (!isValidPhone(value)) error = '올바른 연락처를 입력해주세요';
      break;
    // ... 기타 필드
  }
  setFieldErrors(prev => ({ ...prev, [fieldName]: error }));
};
```


**5.12.9.** 접근성 요구사항

1: 입력 필드 접근성

```javascript
<TextInput
  accessibilityLabel="매장명 입력"
  accessibilityHint="고객에게 표시될 매장 이름을 입력하세요"
  accessibilityState={{ invalid: !!fieldErrors.storeName }}
/>
```

2: 자동 기입 필드 알림

```javascript
<View accessibilityLabel="대표자명: 홍길동 (본인 인증 정보로 자동 입력됨, 수정 불가)">
  <TextInput
    editable={false}
    value={storeInfo.ownerName}
  />
</View>
```


• 참조: 7-1-1-6. 사업자 인증
