**3.6.3.** 메뉴 생성 및 관리  


**3.6.3.1.** 메뉴 생성 API  

　1: 엔드포인트: POST /api/partner/onboarding/menus  
　　A. 요청 데이터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| name | string | ✓ | 메뉴명 (최대 20자) |  
| name_en | string | - | 영문 메뉴명 (최대 20자) |  
| description | string | - | 메뉴 설명 (최대 100자) |  
| category_id | string | ✓ | 카테고리 ID |  
| base_price | number | ✓ | 기본 가격 (원) |  
| discount_price | number | - | 할인 가격 (원) |  
| image_url | string | - | 이미지 URL |  
| option_group_ids | array | - | 옵션 그룹 ID 배열 |  
| sale_status | string | - | 판매 상태 (selling/paused/soldout, 기본값: selling) |  
| soldout_auto_reset | boolean | - | 솔드아웃 다음날 자동 해제 (기본값: true) |  
| exposure_type | string | - | 노출 유형 (always/time_limited, 기본값: always) |  
| exposure_preset | string | - | 노출 프리셋 (morning/lunch/teatime/dinner/custom) |  
| exposure_start_time | string | - | 노출 시작 시간 (HH:mm) |  
| exposure_end_time | string | - | 노출 종료 시간 (HH:mm) |  
| exposure_days | array | - | 노출 요일 배열 (mon/tue/wed/thu/fri/sat/sun) |  
| hidden_outside_time | boolean | - | 시간대 외 숨김 여부 (기본값: false) |  
| is_popular | boolean | - | 인기 메뉴 여부 (기본값: false) |  
| allergens | array | - | 알레르기 정보 배열 |  
| is_reward_available | boolean | - | 리워드 사용 가능 여부 (기본값: true) |  
| is_visible | boolean | - | 노출 여부 (기본값: true) |  
| sort_order | number | - | 정렬 순서 |  

　　B. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| menu_id | string | 생성된 메뉴 ID |  
| name | string | 메뉴명 |  
| category_id | string | 카테고리 ID |  
| base_price | number | 기본 가격 |  
| sale_status | string | 판매 상태 |  
| image_url | string | 이미지 URL |  
| created_at | string | 생성 일시 |  

　2: 성공 처리  
　　A. 메뉴 목록에 새 메뉴 추가  
　　B. 메뉴 입력 폼 초기화  
　　C. 성공 토스트 메시지 표시  

　3: 에러 처리  
　　A. 필수 항목 미입력: "필수 항목을 입력해주세요"  
　　B. 메뉴명 중복: "이미 존재하는 메뉴명입니다"  
　　C. 가격 형식 오류: "가격은 숫자로 입력해주세요"  
　　D. 네트워크 에러: "네트워크 연결을 확인해주세요"  


**3.6.3.2.** 메뉴명 중복 검사 API  

　1: 엔드포인트: GET /api/partner/onboarding/menus/check-duplicate  
　　A. 요청 파라미터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| name | string | ✓ | 검사할 메뉴명 |  
| exclude_menu_id | string | - | 제외할 메뉴 ID (수정 시) |  

　　B. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| is_duplicate | boolean | 중복 여부 |  
| existing_menu_id | string | 중복된 메뉴 ID (중복 시) |  

　2: 사용 시점  
　　A. 메뉴명 입력 시 실시간 검사 (debounce 300ms)  
　　B. 저장 버튼 클릭 시 최종 검사  

　3: 클라이언트 처리  
　　A. 중복 시: 입력 필드 에러 표시 + "이미 존재하는 메뉴명입니다" 메시지  
　　B. 중복 아님: 정상 진행  


**3.6.3.3.** 메뉴 수정 API  

　1: 엔드포인트: PUT /api/partner/onboarding/menus/{menu_id}  
　　A. 요청 데이터: 메뉴 생성 API와 동일 (모든 필드 선택)  
　　B. 응답 데이터: 업데이트된 메뉴 정보  

　2: 성공 처리  
　　A. 메뉴 목록에서 해당 메뉴 정보 업데이트  
　　B. 수정 모드 종료  
　　C. 성공 토스트 메시지 표시  


**3.6.3.4.** 메뉴 삭제 API  

　1: 엔드포인트: DELETE /api/partner/onboarding/menus/{menu_id}  
　　A. 요청 데이터: 없음 (URL 파라미터로 menu_id 전달)  
　　B. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| success | boolean | 삭제 성공 여부 |  
| message | string | 삭제 결과 메시지 |  

　2: 성공 처리  
　　A. 메뉴 목록에서 해당 메뉴 제거  
　　B. 성공 토스트 메시지 표시  

　3: 에러 처리  
　　A. 삭제 실패: "메뉴 삭제 중 오류가 발생했습니다"  


**3.6.3.5.** 메뉴 판매 상태 변경 API  

　1: 엔드포인트: PATCH /api/partner/onboarding/menus/{menu_id}/status  
　　A. 요청 데이터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| sale_status | string | ✓ | 판매 상태 (selling/paused/soldout) |  
| soldout_auto_reset | boolean | - | 솔드아웃 자동 해제 여부 |  

　　B. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| success | boolean | 변경 성공 여부 |  
| sale_status | string | 변경된 판매 상태 |  

　2: 성공 처리  
　　A. 메뉴 목록에서 해당 메뉴 상태 업데이트  
　　B. 성공 토스트 메시지: "판매 상태가 변경되었습니다"  


**3.6.3.6.** 메뉴 복사 API  

　1: 엔드포인트: POST /api/partner/onboarding/menus/{menu_id}/copy  
　　A. 요청 데이터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| new_name | string | - | 새 메뉴명 (기본값: "[원본명] (복사본)") |  

　　B. 응답 데이터: 복사된 새 메뉴 정보  

　2: 복사 처리  
　　A. 원본 메뉴의 모든 정보 복사 (이미지 포함)  
　　B. 새로운 menu_id 부여  
　　C. 메뉴명 변경: "[원본명] (복사본)"  
　　D. sale_status: "selling"으로 초기화  
　　E. sort_order: 원본 메뉴 다음 순서로 설정  


**3.6.3.7.** 메뉴 이미지 업로드 API  

　1: 엔드포인트: POST /api/partner/onboarding/menus/upload-image  
　　A. 요청 데이터 (multipart/form-data)  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| image | file | ✓ | 이미지 파일 (최대 5MB) |  

　　B. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| image_url | string | 업로드된 이미지 URL |  
| thumbnail_url | string | 썸네일 이미지 URL (200x200) |  
| optimized_url | string | 최적화된 이미지 URL (500x500) |  
| original_url | string | 원본 크기 이미지 URL (1000x1000) |  

　2: 이미지 처리 (서버)  
　　A. 1:1 비율 Crop (클라이언트에서 처리된 경우 스킵)  
　　B. 자동 리사이징: 1000x1000px 이하로 조정  
　　C. 자동 압축: 품질 80~90% 유지  
　　D. 썸네일 생성: 200x200px  
　　E. CDN 업로드 및 URL 반환  

　3: 에러 처리  
　　A. 파일 크기 초과: "파일 크기는 5MB 이하여야 합니다"  
　　B. 파일 형식 오류: "지원하는 이미지 형식은 JPG, PNG, WebP입니다"  


**3.6.3.8.** 메뉴 순서 변경 API  

　1: 엔드포인트: PUT /api/partner/onboarding/menus/reorder  
　　A. 요청 데이터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| category_id | string | ✓ | 카테고리 ID |  
| menu_orders | array | ✓ | 메뉴 순서 배열 |  

　　B. menu_orders 배열 구조  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| menu_id | string | 메뉴 ID |  
| sort_order | number | 정렬 순서 (1부터 시작) |  

　　C. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| success | boolean | 저장 성공 여부 |  
| updated_count | number | 업데이트된 메뉴 개수 |  

　2: 성공 처리  
　　A. 메뉴 목록 순서 업데이트  
　　B. 성공 토스트: "메뉴 순서가 저장되었습니다"  


**3.6.3.9.** 메뉴 일괄 저장 API  

　1: 엔드포인트: POST /api/partner/onboarding/menus/batch-save  
　　A. 요청 데이터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| menus | array | ✓ | 메뉴 정보 배열 |  

　　B. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| success | boolean | 저장 성공 여부 |  
| saved_count | number | 저장된 메뉴 개수 |  
| failed_count | number | 저장 실패한 메뉴 개수 |  
| failed_items | array | 실패한 메뉴 상세 정보 |  

　2: 성공 처리  
　　A. 모든 메뉴 정보 저장 완료  
　　B. 다음 단계로 화면 전환  
　　C. 성공 토스트 메시지 표시  

　3: 부분 실패 처리  
　　A. 일부 메뉴만 저장 성공: "N개 중 M개 메뉴가 저장되었습니다"  
　　B. 실패한 메뉴 목록 표시  


**3.6.3.10.** 엑셀 일괄 등록 API  

　1: 템플릿 다운로드  
　　A. 엔드포인트: GET /api/partner/onboarding/menus/template  
　　B. 응답: 엑셀 템플릿 파일 (.xlsx)  

　2: 엑셀 업로드 및 검증  
　　A. 엔드포인트: POST /api/partner/onboarding/menus/upload-excel  
　　B. 요청 데이터 (multipart/form-data)  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| file | file | ✓ | 엑셀 파일 (최대 10MB) |  
| auto_create_category | boolean | - | 새 카테고리 자동 생성 여부 |  

　　C. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| total_rows | number | 전체 행 수 |  
| valid_rows | number | 유효한 행 수 |  
| error_rows | number | 오류 행 수 |  
| preview | array | 미리보기 데이터 (상위 50개) |  
| errors | array | 오류 상세 정보 |  
| new_categories | array | 발견된 새 카테고리 목록 |  

　3: 엑셀 일괄 저장  
　　A. 엔드포인트: POST /api/partner/onboarding/menus/save-excel  
　　B. 요청 데이터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| upload_id | string | ✓ | 업로드 ID (검증 단계에서 반환) |  
| skip_errors | boolean | - | 오류 항목 건너뛰기 여부 |  

　　C. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| success | boolean | 저장 성공 여부 |  
| saved_count | number | 저장된 메뉴 개수 |  
| skipped_count | number | 건너뛴 메뉴 개수 |  
| failed_items | array | 실패한 항목 상세 |  


**3.6.3.11.** 이미지 일괄 업로드 API  

　1: 엔드포인트: POST /api/partner/onboarding/menus/upload-images-zip  
　　A. 요청 데이터 (multipart/form-data)  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| file | file | ✓ | ZIP 파일 (최대 100MB) |  

　　B. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| total_images | number | 전체 이미지 수 |  
| matched_count | number | 메뉴와 매칭된 이미지 수 |  
| unmatched_count | number | 매칭되지 않은 이미지 수 |  
| matched_items | array | 매칭된 항목 목록 |  
| unmatched_items | array | 매칭되지 않은 이미지 목록 |  

　2: 매칭 확인 후 저장  
　　A. 엔드포인트: POST /api/partner/onboarding/menus/apply-images  
　　B. 요청 데이터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| upload_id | string | ✓ | 업로드 ID |  
| manual_matches | array | - | 수동 매칭 정보 |  

　　C. 응답 데이터  

| 필드 | 타입 | 설명 |  
|---|---|---|  
| success | boolean | 적용 성공 여부 |  
| applied_count | number | 적용된 이미지 수 |  


**3.6.3.12.** 메뉴 내보내기 API  

　1: 엔드포인트: GET /api/partner/onboarding/menus/export  
　　A. 요청 파라미터  

| 필드 | 타입 | 필수 | 설명 |  
|---|---|---|---|  
| format | string | - | 파일 형식 (xlsx, csv) 기본값: xlsx |  
| category_id | string | - | 특정 카테고리만 내보내기 |  

　　B. 응답: 엑셀 또는 CSV 파일 다운로드  


**3.6.3.13.** 솔드아웃 자동 해제 스케줄러  

　1: 스케줄러 설정  
　　A. 실행 시간: 매일 오전 6시  
　　B. 대상: soldout_auto_reset = true 인 메뉴  
　　C. 처리: sale_status를 "selling"으로 변경  

　2: 로그 기록  
　　A. 자동 해제된 메뉴 ID 및 시간 기록  
　　B. 파트너에게 알림 (선택 사항)  

