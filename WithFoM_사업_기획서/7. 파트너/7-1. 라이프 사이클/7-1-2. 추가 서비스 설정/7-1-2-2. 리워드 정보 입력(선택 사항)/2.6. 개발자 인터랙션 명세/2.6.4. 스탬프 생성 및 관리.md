**2.6.4.** 스탬프 생성 및 관리  


**1.6.4.1.** 스탬프 카드 생성  

　1: 스탬프 카드 정보 입력  
　　A. 상태 관리: stampCard 객체 생성/업데이트  
　　B. 스탬프 카드 객체 구조  
　　　　a. earn_threshold: 1개 적립 기준 금액 (원)  
　　　　b. multiple_earn_enabled: 다중 스탬프 적립 활성화 여부 (boolean)  
　　　　c. valid_period: 유효 기간 객체  
　　　　　　• type: "fixed" | "unlimited"  
　　　　　　• duration: 기간 (3개월, 6개월, 1년, 사용자 지정)  
　　　　　　• start_date: 시작일 (사용자 지정 시)  
　　　　　　• end_date: 종료일 (사용자 지정 시)  
　　　　d. daily_limit: 1일 적립 한도 (개, 선택, null 시 무제한)  
　　　　e. exclusions: 적립 제외 항목 객체  
　　　　　　• promo_products: 행사 제품 제외 여부 (boolean)  
　　　　　　• discounted_products: 할인 상품 제외 여부 (boolean)  
　　　　　　• md_products: MD 상품 제외 여부 (boolean)  
　　　　f. rewards: N개 적립 시 혜택 배열 (최대 3개)  

　2: 기본값 적용  
　　A. earn_threshold: 3,000원 (권장)  
　　B. multiple_earn_enabled: false  
　　C. valid_period: 1년  
　　D. daily_limit: null (무제한)  
　　E. exclusions: discounted_products = true (할인 메뉴 제외 권장), 나머지 false  

　3: 스탬프는 1종만 생성 가능  
　　A. 기존 스탬프가 있으면 새로 생성 불가  
　　B. 기존 스탬프 수정만 가능  


**1.6.4.2.** 다중 스탬프 적립 설정  

　1: 토글 스위치 상태 변경  
　　A. ON 시: multiple_earn_enabled = true  
　　B. OFF 시: multiple_earn_enabled = false (기본값)  

　2: 다중 적립 계산 로직 (배수 적립 방식)  
　　A. 계산 공식: 적립 개수 = Math.floor(결제 금액 / earn_threshold)  
　　B. 예시 (earn_threshold = 3,000원):  
　　　　a. 2,999원: 0개 (기준 금액 미달)  
　　　　b. 3,000원: 1개  
　　　　c. 5,999원: 1개  
　　　　d. 6,000원: 2개  
　　　　e. 9,000원: 3개  

　3: multiple_earn_enabled = false 시  
　　A. 기준 금액 이상이면 1개만 적립  
　　B. 결제 금액 ≥ earn_threshold → 1개  
　　C. 결제 금액 < earn_threshold → 0개  


**1.6.4.3.** 적립 제외 항목 설정  

　1: 체크박스 상태 변경  
　　A. 각 체크박스 클릭 시 exclusions 객체 업데이트  
　　B. 체크 시: 해당 항목 제외  
　　C. 체크 해제 시: 해당 항목 적립 가능  

　2: 할인 적용 메뉴 제외 (discounted_products)  
　　A. 메뉴 관리에서 discount_price가 설정된 메뉴는 스탬프 적립 대상에서 제외  
　　B. 할인이 해제되면 자동으로 적립 가능 상태로 변경  
　　C. 권장값: true (할인 메뉴 제외)  
　　D. 이유: 이중 할인 방지, 마진 보호  

　3: 적립 제외 로직  
　　A. 결제 시 주문 항목 확인  
　　B. 제외 항목에 해당하는 메뉴 금액 차감  
　　　　a. discounted_products = true: 할인가 설정된 메뉴 금액 제외  
　　　　b. promo_products = true: 행사 메뉴 금액 제외  
　　　　c. md_products = true: MD 상품 금액 제외  
　　C. 차감 후 금액으로 스탬프 계산  


**1.6.4.4.** 스탬프 혜택 추가  

　1: "혜택 추가" 버튼 클릭  
　　A. stampCard.rewards 배열에 새 혜택 객체 추가  
　　B. 혜택 객체 구조  
　　　　a. count: 적립 개수 (개)  
　　　　b. reward: 혜택 내용 (텍스트, 최대 20자)  

　2: 최대 개수 확인  
　　A. 혜택 최대 3개까지 생성 가능  
　　B. 3개 도달 시: 추가 버튼 비활성화  

　3: 혜택 삭제  
　　A. X 버튼 클릭 시 해당 혜택 제거  
　　B. 최소 1개 혜택 필수 유지  
　　C. 마지막 1개 남은 경우: 삭제 버튼 비활성화  


**1.6.4.5.** 스탬프 입력 필드 유효성 검사  

　1: 실시간 검증  
　　A. 적립 기준 금액: 필수, 숫자, 1,000원 이상 권장  
　　B. 유효 기간: 미설정 체크박스 선택 시 또는 기간 선택 시  
　　C. 1일 적립 한도: 숫자, 1 이상 (입력 시)  
　　D. 혜택 적립 개수: 숫자, 1 이상, 중복 불가  
　　E. 혜택 내용: 필수, 1~20자  

　2: 에러 메시지  
　　A. 적립 기준 금액 미입력: "적립 기준 금액을 입력해주세요"  
　　B. 혜택 적립 개수 중복: "스탬프 혜택 적립 개수는 중복될 수 없습니다"  
　　C. 혜택 내용 초과: "혜택 내용은 20자 이내로 입력해주세요"  
　　D. 혜택 미입력: "최소 1개의 혜택을 설정해주세요"  

