**2.5.1.** API 및 데이터 처리  


**2.5.1.1.** 화면 초기 로딩  

　1: API 호출  
　　A. `GET /api/v1/partner/coins` — 파트너 코인 현황 조회  
　　B. `GET /api/v1/partner/game/current` — 현재 게임 조회 (매장당 1개)  
　　C. `GET /api/v1/partner/membership/current` — 멤버십 정보 및 증정 코인 확인  

　2: 응답 데이터  
　　A. total_coins: 총 보유 코인  
　　B. allocated_coins: 게임에 적립된 코인  
　　C. available_coins: 사용 가능 코인  
　　D. monthly_bonus: 이번 달 증정 코인  


**2.5.1.2.** 폼 코인 구매  

　1: API 호출  
　　A. `POST /api/v1/partner/coins/purchase`  
　　B. Request: `{ quantity: number, paymentMethodId: string, idempotencyKey: string }`  
　　C. Response: `{ success: boolean, newBalance: number, transactionId: string }`  

　2: 결제 처리  
　　A. PG사 결제 API 연동  
　　B. 결제 성공 시 코인 즉시 반영  
　　C. 결제 실패 시 에러 메시지 표시  
　　D. idempotencyKey로 이중 결제 방지  


**2.5.1.3.** 게임 생성/수정  

　1: 게임 생성 API  
　　A. `POST /api/v1/partner/game`  
　　B. Request: `{ type: "ROULETTE"|"GACHA"|"SCRATCH"|"LADDER", name: string, description: string, theme: string }`  
　　C. 기존 게임 존재 시 에러: `{ error: "GAME_ALREADY_EXISTS" }`  

　2: 게임 수정 API  
　　A. `PUT /api/v1/partner/game/{gameId}`  
　　B. 이름, 설명, 테마 변경 (유형은 변경 불가, 유형 변경은 별도 API)  

　3: 게임 유형 변경 API  
　　A. `POST /api/v1/partner/game/change-type`  
　　B. Request: `{ newType: string, name: string, description: string, theme: string }`  
　　C. 기존 게임 자동 삭제 → 새 게임 생성 (트랜잭션)  
　　D. 횟수 초과 시 에러: `{ error: "TYPE_CHANGE_LIMIT_EXCEEDED", resetsAt: "YYYY-MM-DD" }`  

　4: 유효성 검증  
　　A. 확률 합계 = 100% 검증  
　　B. 리워드 연결 유효성 검증  
　　C. 기존 게임 존재 여부 검증 (매장당 1개)  


**2.5.1.4.** 코인 적립 및 제공 설정  

　1: 코인 적립 API  
　　A. `POST /api/v1/partner/game/{gameId}/allocate`  
　　B. Request: `{ amount: number }`  

　2: 무료 게임 설정 API  
　　A. `PUT /api/v1/partner/game/{gameId}/free-play`  
　　B. Request: `{ dailyLimit: number, targetCustomers: array, timeRange: object }`  


**2.5.1.5.** 에러 처리  

　1: 코인 부족  
　　A. 적립 또는 구매 필요 안내  
　　B. 코인 구매 페이지로 이동 버튼  

　2: 결제 실패  
　　A. 실패 사유 표시 (카드 한도, 네트워크 오류 등)  
　　B. 재시도 또는 다른 결제 수단 안내  

　3: 유효성 오류  
　　A. 확률 합계 불일치 시 조정 안내  
　　B. 필수 입력 누락 시 해당 필드 강조  


• 참조: 7-2-7-1. 게임 설정 > 1.9. 개발자 인터랙션 명세, 7-2-7-2. 코인 관리 > 2.9. 개발자 인터랙션 명세  
